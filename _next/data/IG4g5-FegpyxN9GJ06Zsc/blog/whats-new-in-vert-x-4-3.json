{"pageProps":{"categories":["releases","guides","security","news"],"post":{"meta":{"title":"What's new in Vert.x 4.3","category":"releases","authors":[{"name":"Julien Viet","github_id":"vietj"}],"summary":"See an overview of all new and exciting features in Vert.x 4.3, including Web Client URL templates, JSON schema improvements, more compression algorithms, dynamic codec lookup, and more.","pinned":true},"date":"2022-05-12","slug":"whats-new-in-vert-x-4-3","readingTime":{"text":"7 min read","minutes":6.525,"time":391500,"words":1305},"content":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = props.components || ({});\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, {})\n  })) : _createMdxContent();\n  function _createMdxContent() {\n    const _components = Object.assign({\n      p: \"p\",\n      h2: \"h2\",\n      a: \"a\",\n      pre: \"pre\",\n      code: \"code\",\n      span: \"span\",\n      ul: \"ul\",\n      li: \"li\",\n      h3: \"h3\",\n      ol: \"ol\",\n      h4: \"h4\",\n      em: \"em\"\n    }, props.components), {Link} = _components;\n    if (!Link) _missingMdxReference(\"Link\", true);\n    return _jsxs(_Fragment, {\n      children: [_jsx(_components.p, {\n        children: \"Vert.x 4.3 comes with plenty of new ex­cit­ing fea­tures.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Here is an overview of the most im­por­tant fea­tures in Vert.x 4.3.\"\n      }), \"\\n\", _jsxs(_components.h2, {\n        id: \"web-client-uri-templates\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#web-client-uri-templates\"\n        }), \"Web Client URI templates\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"URI tem­plates pro­vide an al­ter­na­tive to HTTP re­quest string URIs based on the \", _jsx(_components.a, {\n          href: \"https://datatracker.ietf.org/doc/html/rfc6570\",\n          children: \"URI Tem­plate RFC\"\n        }), \".\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"A Vert.x URI \", _jsx(Link, {\n          href: \"/docs/vertx-uri-template/java/\",\n          passHref: true,\n          children: _jsx(_components.a, {\n            href: \"\",\n            children: \"tem­plate\"\n          })\n        }), \" can be cre­ated as fol­lows:\"]\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-java\",\n          children: [_jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"UriTemplate\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-variable\",\n            children: \"REQUEST_URI\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-operator\",\n            children: \"=\"\n          }), \" UriTemplate.of(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"/users{/user}\\\"\"\n          }), \");\\n\"]\n        })\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"A web client can \", _jsx(Link, {\n          href: \"/docs/vertx-web-client/java/#_uri_templates\",\n          passHref: true,\n          children: _jsx(_components.a, {\n            href: \"\",\n            children: \"use it\"\n          })\n        }), \" to send a re­quest:\"]\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-java\",\n          children: [\"client.get(\", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"80\"\n          }), \", \", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"myserver.mycompany.com\\\"\"\n          }), \", REQUEST_URI)\\n  .setTemplateParam(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"user\\\"\"\n          }), \", \", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"cooper\\\"\"\n          }), \")\\n  .send()\\n  .onSuccess(res ->\\n    System.out.println(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"Received response with status code\\\"\"\n          }), \" + res.statusCode()))\\n  .onFailure(err ->\\n    System.out.println(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"Something went wrong \\\"\"\n          }), \" + err.getMessage()));\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"URI tem­plates ex­pan­sion mech­a­nism takes care of en­cod­ing pa­ra­me­ter val­ues. It can also han­dle lists and maps.\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"Sev­eral ex­pan­sion \", _jsx(Link, {\n          href: \"/docs/vertx-uri-template/java/#expansion_styles\",\n          passHref: true,\n          children: _jsx(_components.a, {\n            href: \"\",\n            children: \"styles\"\n          })\n        }), \" are avail­able for each rel­e­vant part of a URI.\"]\n      }), \"\\n\", _jsxs(_components.h2, {\n        id: \"json-schema\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#json-schema\"\n        }), \"Json Schema\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Json Schema val­i­da­tion has re­ceived a major up­date. In 4.3, we in­tro­duce sup­port for more drafts:\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"Draft 4 (used by Swag­ger and Ope­nAPI 3.0)\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"Draft 7 (gen­er­ally used by many ser­vices)\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"Draft 2019-09\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"Draft 2020-12 (used by Ope­nAPI 3.1)\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"This refac­tor­ing re­quired that the pre­vi­ous im­ple­men­ta­tion was dep­re­cated and will be re­placed with a poly­glot friendly\\nal­ter­na­tive. In a nut­shell, the new API can be used as fol­lows:\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-java\",\n          children: [_jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// when dealing with multiple schema resources, we need a repository:\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// 'options' defines the validation draft to be used, base uri, etc...\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"SchemaRepository\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-variable\",\n            children: \"repository\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-operator\",\n            children: \"=\"\n          }), \" SchemaRepository.create(options);\\n\\n\", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// create a schema object\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"JsonSchema\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-variable\",\n            children: \"schema\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-operator\",\n            children: \"=\"\n          }), \" JsonSchema.of(jsonObject);\\n\\n\", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// perform validation (if not using a repository)\"\n          }), \"\\nschema.validate(anyObject, options);\\n\", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// or\"\n          }), \"\\nrepository.validator(schema).validate();\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"This work lays the foun­da­tion for fu­ture sup­port of Ope­nAPI in vertx-​web.\"\n      }), \"\\n\", _jsxs(_components.h2, {\n        id: \"vertx-grpc\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#vertx-grpc\"\n        }), \"Vert.x gRPC\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Until 4.3, Vert.x gRPC sup­port was built on top of gRPC Netty. It worked very well but with some fric­tion:\\nNetty ver­sions had to be matched and often forced, which lead to in­com­pat­i­bil­i­ties with Vert.x Web, etc.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"The new gRPC stack for Vert.x gets rid of those lim­i­ta­tions and pro­vides a set of new ex­clu­sive fea­tures built on top of the\\nVert.x HTTP/2 stack.\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"Be­yond im­ple­ment­ing the \", _jsx(Link, {\n          href: \"/docs/vertx-grpc/java/#_stub_api\",\n          passHref: true,\n          children: _jsx(_components.a, {\n            href: \"\",\n            children: \"gRPC stub model\"\n          })\n        }), \",\\nVert.x gRPC has a re­quest/re­sponse API.\"]\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-java\",\n          children: [_jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"GrpcServer\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-variable\",\n            children: \"grpcServer\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-operator\",\n            children: \"=\"\n          }), \" GrpcServer.server(vertx);\\n\\nserver.callHandler(GreeterGrpc.getSayHelloMethod(), request -> {\\n\\n  request.handler(hello -> {\\n\\n    GrpcServerResponse<HelloRequest, HelloReply> response = request.response();\\n\\n    \", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"HelloReply\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-variable\",\n            children: \"reply\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-operator\",\n            children: \"=\"\n          }), \" HelloReply.newBuilder().setMessage(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"Hello \\\"\"\n          }), \" + hello.getName()).build();\\n\\n    response.end(reply);\\n  });\\n});\\n\\nvertx.createHttpServer(options);\\n  .requestHandler(grpcServer)\\n  .listen();\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"This API can also be used with pro­to­buf data in­stead of de­coded pro­to­buf, giv­ing the op­por­tu­nity to eas­ily build gRPC\\nprox­ies with Vert.x:\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsx(_components.code, {\n          className: \"hljs language-java\",\n          children: \"grpcServer.callHandler(clientReq -> {\\n  clientReq.pause();\\n  client.request(serverAddress).onSuccess(proxyReq -> {\\n    proxyReq.response().onSuccess(resp -> {\\n      GrpcServerResponse<Buffer, Buffer> bc = clientReq.response();\\n      resp.messageHandler(bc::writeMessage);\\n      resp.endHandler(v -> bc.end());\\n    });\\n    proxyReq.fullMethodName(clientReq.fullMethodName());\\n    clientReq.messageHandler(proxyReq::writeMessage);\\n    clientReq.endHandler(v -> proxyReq.end());\\n    clientReq.resume();\\n  });\\n});\\n\"\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"No­tice that the proxy does not need to ref­er­ence gen­er­ated stubs at any time. It works uni­ver­sally for any gRPC ser­vice.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"The proxy can for­ward com­pressed mes­sages with­out in­ter­me­di­ate de­com­pres­sion if the prox­ied server\\nsup­ports com­pres­sion.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Fi­nally, the Vert.x gRPC server can be used within a Vert.x Web router:\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-java\",\n          children: [\"GreeterGrpc.\", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"GreeterImplBase\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-variable\",\n            children: \"service\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"new\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-title class_\",\n            children: \"GreeterGrpc\"\n          }), \".GreeterImplBase() {\\n  \", _jsx(_components.span, {\n            className: \"hljs-meta\",\n            children: \"@Override\"\n          }), \"\\n  \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"public\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"void\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-title function_\",\n            children: \"sayHello\"\n          }), _jsx(_components.span, {\n            className: \"hljs-params\",\n            children: \"(HelloRequest request, StreamObserver<HelloReply> responseObserver)\"\n          }), \" {\\n    responseObserver.onNext(HelloReply.newBuilder().setMessage(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"Hello \\\"\"\n          }), \" + request.getName()).build());\\n    responseObserver.onCompleted();\\n  }\\n};\\n\\n\", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"GrpcServer\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-variable\",\n            children: \"grpcServer\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-operator\",\n            children: \"=\"\n          }), \" GrpcServer.server(vertx);\\n\", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"GrpcServiceBridge\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-variable\",\n            children: \"serverStub\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-operator\",\n            children: \"=\"\n          }), \" GrpcServiceBridge.bridge(service);\\nserverStub.bind(grpcServer);\\n\\nrouter.consumes(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"application/grpc\\\"\"\n          }), \").handler(grpcServer);\\n\"]\n        })\n      }), \"\\n\", _jsxs(_components.h3, {\n        id: \"extra-http-compression-algorithms\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#extra-http-compression-algorithms\"\n        }), \"Extra HTTP compression algorithms\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"Vert.x HTTP servers can now \", _jsx(Link, {\n          href: \"/docs/vertx-core/java/#_http_compression_algorithms\",\n          passHref: true,\n          children: _jsx(_components.a, {\n            href: \"\",\n            children: \"com­press\"\n          })\n        }), \" to Brotli and Zs­tan­dard in ad­di­tion to GZIP.\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"Vert.x HTTP client can now \", _jsx(Link, {\n          href: \"/docs/vertx-core/java/#_handling_compressed_body\",\n          passHref: true,\n          children: _jsx(_components.a, {\n            href: \"\",\n            children: \"de­com­press\"\n          })\n        }), \" Brotli in ad­di­tion to GZIP.\"]\n      }), \"\\n\", _jsxs(_components.h3, {\n        id: \"vertx-web\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#vertx-web\"\n        }), \"Vertx Web\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Fig­ur­ing out the right order for han­dlers can be some­times tricky.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"In 4.3, we now check the order when mul­ti­ple han­dlers are added under the same route. In­cor­rect se­tups are sig­naled.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"For ex­am­ple, adding a user han­dler be­fore a body han­dler will raise an error:\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-java\",\n          children: [_jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// Incorrect setup, but allowed before 4.3.0\"\n          }), \"\\nrouter.route(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"/api\\\"\"\n          }), \")\\n  .handler(ctx -> {\\n    \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// this would always print `null`\"\n          }), \"\\n    System.out.println(ctx.body().toString());\\n    ctx.next();\\n  })\\n  .handler(BodyHandler.create());\\n\\n\", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// Correct setup, that will be allowed from 4.3.0\"\n          }), \"\\nrouter.route(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"/api\\\"\"\n          }), \")\\n  .handler(BodyHandler.create());\\n  .handler(ctx -> {\\n    \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// Now it correctly prints the request body\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// as vertx-web guarantees that the body handler\"\n          }), \"\\n    \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// has been executed before\"\n          }), \"\\n    System.out.println(ctx.body().toString());\\n    ctx.next();\\n  })\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"The val­i­da­tion will ver­ify that han­dlers are added in the fol­low­ing order:\"\n      }), \"\\n\", _jsxs(_components.ol, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"PLATFORM\"\n          }), \": plat­form han­dlers (\", _jsx(_components.code, {\n            children: \"LoggerHandler\"\n          }), \", \", _jsx(_components.code, {\n            children: \"FaviconHandler\"\n          }), \", etc.)\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"SECURITY_POLICY\"\n          }), \": HTTP Se­cu­rity poli­cies (\", _jsx(_components.code, {\n            children: \"CSPHandler\"\n          }), \", \", _jsx(_components.code, {\n            children: \"CorsHandler\"\n          }), \", etc.)\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"BODY\"\n          }), \": Body pars­ing (\", _jsx(_components.code, {\n            children: \"BodyHandler\"\n          }), \")\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"AUTHENTICATION\"\n          }), \": Authn (\", _jsx(_components.code, {\n            children: \"JWTAuthHandler\"\n          }), \", \", _jsx(_components.code, {\n            children: \"APIKeyHandler\"\n          }), \", \", _jsx(_components.code, {\n            children: \"WebauthnHandler\"\n          }), \", etc.)\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"INPUT_TRUST\"\n          }), \": Input ver­i­fi­ca­tion (\", _jsx(_components.code, {\n            children: \"CSRFHandler\"\n          }), \")\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"AUTHORIZATION\"\n          }), \": Authz (\", _jsx(_components.code, {\n            children: \"AuthorizationHandler\"\n          }), \")\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"If your han­dler is per­form­ing any spe­cific task, you can mark it as any of these by adding the marker in­ter­face to your\\nim­ple­men­ta­tion.\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"In ad­di­tion, se­cu­rity han­dlers using call­backs now en­sure that call­backs are added in the right order, re­liev­ing from\\ncre­at­ing tem­po­rary ob­jects:\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-java\",\n          children: [_jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// Before 4.3.0\"\n          }), \"\\n\\n\", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// Need a reference to a route, so it gets added before the oauth2 handler\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"Route\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-variable\",\n            children: \"callback\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-operator\",\n            children: \"=\"\n          }), \" router.route();\\n\\n\", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// add the oauth2 handler to the router\"\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"OAuth2AuthHandler\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-variable\",\n            children: \"oauth2Handler\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-operator\",\n            children: \"=\"\n          }), \" OAuth2AuthHandler\\n    .create(vertx, oauth2, \", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"http://localhost:8080/callback\\\"\"\n          }), \");\\nrouter.route(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"/secure\\\"\"\n          }), \")\\n  .handler(oauth2Handler);\\n\\n\", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// configure the previously allocated route + configure it\"\n          }), \"\\noauth2Handler.setupCallback(callback);\\n\\n\", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// With the safe security setup of 4.3.0\"\n          }), \"\\nrouter.route(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"/secure\\\"\"\n          }), \")\\n  .handler(OAuth2AuthHandler\\n    .create(vertx, oauth2, \", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"http://localhost:8080/callback\\\"\"\n          }), \")\\n    .setupCallback(router.route(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"/callback\\\"\"\n          }), \")));\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Pre­vi­ously, a ref­er­ence to the call­back route had to be cre­ated be­fore the oauth2 han­dler was added. Oth­er­wise, the\\ncall­back han­dler would be shaded.\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"This fea­ture ap­plies to all se­cu­rity han­dlers that use call­backs. For ex­am­ple, \", _jsx(_components.code, {\n          children: \"OAuth2\"\n        }), \", \", _jsx(_components.code, {\n          children: \"OTP\"\n        }), \", and \", _jsx(_components.code, {\n          children: \"Webauthn\"\n        }), \".\"]\n      }), \"\\n\", _jsxs(_components.h4, {\n        id: \"other-notable-improvements\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#other-notable-improvements\"\n        }), \"Other notable improvements\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"Other small im­prove­ments were on pro­cess­ing the body of the re­quest. We now cache the body which avoids pars­ing its\\ncon­tent on each \", _jsx(_components.code, {\n          children: \"ctx.getBodyAsXXX()\"\n        }), \" in­vo­ca­tion and fi­nally, \", _jsx(_components.code, {\n          children: \"BodyHandler\"\n        }), \" will now re­spect the HTTP di­rec­tive\\n\", _jsx(_components.code, {\n          children: \"Expect: Continue\"\n        }), \" when pro­cess­ing up­loads, in­form­ing clients that they are al­lowed to start up­load­ing if val­i­da­tion\\nis cor­rect.\"]\n      }), \"\\n\", _jsxs(_components.h3, {\n        id: \"mysql-client-pipelining-support\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#mysql-client-pipelining-support\"\n        }), \"MySQL client pipelining support\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"The re­ac­tive MySQL client now sup­ports pipelin­ing like its elder brother the re­ac­tive Post­greSQL client.\"\n      }), \"\\n\", _jsxs(_components.h3, {\n        id: \"reactive-microsoft-sql-server-client\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#reactive-microsoft-sql-server-client\"\n        }), \"Reactive Microsoft SQL Server client\"]\n      }), \"\\n\", _jsxs(_components.h4, {\n        id: \"cursors-and-streaming\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#cursors-and-streaming\"\n        }), \"Cursors and streaming\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"The Re­ac­tive Mi­crosoft SQL Server client sup­ports \", _jsx(Link, {\n          href: \"/docs/vertx-mssql-client/java/#_cursors_and_streaming\",\n          passHref: true,\n          children: _jsx(_components.a, {\n            href: \"\",\n            children: \"cur­sor fetch­ing and stream­ing\"\n          })\n        }), \" like the Post­greSQL and MySQL client.\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"For ex­am­ple, you can cre­ate a \", _jsx(_components.code, {\n          children: \"RowStream\"\n        }), \" using from a \", _jsx(_components.code, {\n          children: \"PreparedStatement\"\n        }), \":\"]\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-java\",\n          children: [\"connection.prepare(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"SELECT * FROM users WHERE age > @p1\\\"\"\n          }), \", ar1 -> {\\n  \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"if\"\n          }), \" (ar1.succeeded()) {\\n    \", _jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"PreparedStatement\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-variable\",\n            children: \"pq\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-operator\",\n            children: \"=\"\n          }), \" ar1.result();\\n\\n    \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// Fetch 50 rows at a time\"\n          }), \"\\n    RowStream<Row> stream = pq.createStream(\", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"50\"\n          }), \", Tuple.of(\", _jsx(_components.span, {\n            className: \"hljs-number\",\n            children: \"18\"\n          }), \"));\\n\\n    \", _jsx(_components.span, {\n            className: \"hljs-comment\",\n            children: \"// Use the stream\"\n          }), \"\\n    stream.exceptionHandler(err -> {\\n      System.out.println(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"Error: \\\"\"\n          }), \" + err.getMessage());\\n    });\\n    stream.endHandler(v -> {\\n      System.out.println(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"End of stream\\\"\"\n          }), \");\\n    });\\n    stream.handler(row -> {\\n      System.out.println(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"User: \\\"\"\n          }), \" + row.getString(\", _jsx(_components.span, {\n            className: \"hljs-string\",\n            children: \"\\\"last_name\\\"\"\n          }), \"));\\n    });\\n  }\\n});\\n\"]\n        })\n      }), \"\\n\", _jsxs(_components.h4, {\n        id: \"more-data-types\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#more-data-types\"\n        }), \"More data types\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Start­ing with this re­lease, it is pos­si­ble to read from and write to columns of the fol­low­ing types:\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: _jsx(_components.code, {\n            children: \"varbinary(max)\"\n          })\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"text\"\n          }), \" / \", _jsx(_components.code, {\n            children: \"ntext\"\n          })]\n        }), \"\\n\", _jsx(_components.li, {\n          children: _jsx(_components.code, {\n            children: \"image\"\n          })\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.h3, {\n        id: \"user-experience-improvements-in-shared-data-and-event-bus-areas\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#user-experience-improvements-in-shared-data-and-event-bus-areas\"\n        }), \"User experience improvements in Shared Data and Event Bus areas\"]\n      }), \"\\n\", _jsxs(_components.h4, {\n        id: \"clusterserializable-as-a-public-api-member\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#clusterserializable-as-a-public-api-member\"\n        }), _jsx(_components.code, {\n          children: \"ClusterSerializable\"\n        }), \" as a public API member\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"The in­ter­face \", _jsx(_components.code, {\n          children: \"io.vertx.core.shareddata.impl.ClusterSerializable\"\n        }), \" \", _jsx(_components.a, {\n          href: \"https://github.com/vert-x3/wiki/wiki/4.3.0-Deprecations-and-breaking-changes#interface-iovertxcoreshareddataimplclusterserializable-deprecated-and-made-public\",\n          children: \"has been made pub­lic\"\n        }), \".\\nIn pre­vi­ous ver­sions, it was in an im­ple­men­ta­tion pack­age and this had dis­cour­aged some users to rely on it.\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"If you didn’t know, types im­ple­ment­ing \", _jsx(_components.code, {\n          children: \"ClusterSerializable\"\n        }), \" can be shared in \", _jsx(Link, {\n          href: \"/docs/vertx-core/java/#_asynchronous_shared_maps\",\n          passHref: true,\n          children: _jsx(_components.a, {\n            href: \"\",\n            children: \"async maps\"\n          })\n        }), \".\"]\n      }), \"\\n\", _jsxs(_components.h4, {\n        id: \"more-types-supported\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#more-types-supported\"\n        }), \"More types supported\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"In this ver­sion, it is pos­si­ble to share ob­jects of types \", _jsx(_components.code, {\n          children: \"java.io.Serializable\"\n        }), \" or \", _jsx(_components.code, {\n          children: \"io.vertx.core.shareddata.ClusterSerializable\"\n        }), \" in shared data maps and on the Event Bus.\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"For safety rea­sons though, only ap­proved classes are al­lowed to be en­coded and de­coded as mes­sage bod­ies on the Event Bus.\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"For ex­am­ple, this is how to con­trol which \", _jsx(_components.code, {\n          children: \"Serializable\"\n        }), \" classes can be al­lowed:\"]\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-java\",\n          children: [\"vertx.eventBus().serializableChecker(className -> {\\n  \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"return\"\n          }), \" EventBus.DEFAULT_SERIALIZABLE_CHECKER.apply(className) || className.startsWith(AsyncMapTest.class.getName());\\n});\\n\"]\n        })\n      }), \"\\n\", _jsxs(_components.h4, {\n        id: \"dynamic-codec-lookup\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#dynamic-codec-lookup\"\n        }), \"Dynamic codec lookup\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"When send­ing a mes­sage on the Event Bus, Vert.x uses the codec spec­i­fied in \", _jsx(_components.code, {\n          children: \"DeliveryOptions\"\n        }), \" or chooses one based on the mes­sage body type.\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"In this ver­sion, it is pos­si­ble to choose a reg­is­tered codec when Vert.x has not been able to se­lect one:\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsxs(_components.code, {\n          className: \"hljs language-java\",\n          children: [_jsx(_components.span, {\n            className: \"hljs-type\",\n            children: \"MyEncodeEveryThingWithJacksonCodec\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-variable\",\n            children: \"everyThingWithJacksonCodec\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-keyword\",\n            children: \"new\"\n          }), \" \", _jsx(_components.span, {\n            className: \"hljs-title class_\",\n            children: \"MyEncodeEveryThingWithJacksonCodec\"\n          }), \"();\\nvertx.eventBus().registerCodec(everyThingWithJacksonCodec);\\nvertx.eventBus().codecSelector(body -> everyThingWithJacksonCodec.name());\\n\"]\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"This can solve a few use cases, for ex­am­ple:\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"se­lect­ing a codec that does noth­ing for ob­jects to de­liver lo­cally if you know the ob­ject is im­mutable\"\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"you have many ob­jects gen­er­ated from \", _jsx(_components.code, {\n            children: \".proto\"\n          }), \" files and want to defer to \", _jsx(_components.em, {\n            children: \"Pro­to­col Buffers\"\n          }), \" for se­ri­al­iza­tion/de­se­ri­al­iza­tion\"]\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"you want to use Jack­son Data­bind for any ob­ject\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.h3, {\n        id: \"kafka-3\",\n        children: [_jsx(_components.a, {\n          \"aria-hidden\": true,\n          tabIndex: \"-1\",\n          className: \"heading-anchor\",\n          href: \"#kafka-3\"\n        }), \"Kafka 3\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Our Vert.x Kafka Client has been up­graded to use Apache Kafka Client 3.0\"\n      })]\n    });\n  }\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n"},"prevPost":null,"nextPost":{"meta":{"title":"Migrate from Vert.x 3 to Vert.x 4","category":"guides","authors":[{"name":"Julien Viet","github_id":"vietj"}],"summary":"We provide a clear and well-documented migration path from Vert.x 3.9 to Vert.x 4. Existing users will feel at home with the new version.","pinned":true},"date":"2020-12-02","slug":"from-vert-x-3-to-vert-x-4"},"relatedPosts":[{"meta":{"title":"Things to keep in mind concerning CSRF attacks","category":"guides","authors":[{"name":"Xhelal Likaj","github_id":"xhlika"}],"summary":"Eclipse Vert.x like most frameworks provides an anti-CSRF defense. However, no framework can prevent all attack vectors that exist in the web. Therefore, developers need to be aware of some dangers and common attack vectors concerning CSRF defenses."},"date":"2021-01-23","slug":"eclipse-vert-x-CSRF-concerns"},{"meta":{"title":"Real-time bidding with Websockets and Vert.x","category":"guides","authors":[{"name":"Marcin Warczyglowa","github_id":"mwarc"}],"summary":"The expectations of users for interactivity with web applications have changed over the past few years.\n    Users during bidding in auction no longer want to press the refresh button."},"date":"2016-01-15","slug":"real-time-bidding-with-websockets-and-vert-x"},{"meta":{"title":"Some Rest with Vert.x","category":"guides","authors":[{"name":"Clement Escoffier","github_id":"cescoffier"}],"summary":"This post is part of the Introduction to Vert.x series. Let’s go a bit further this time and develop a CRUD-ish application"},"date":"2015-07-27","slug":"some-rest-with-vert-x"}]},"__N_SSG":true}