{"pageProps":{"slug":"3.9.6/vertx-service-discovery-backend-zookeeper/kotlin","title":"Vert.x Discovery Backend - Zookeeper","fallbackGitHubStars":null,"toc":"<div id=\"toc\" class=\"toc\">\n<div id=\"toctitle\">Table of Contents</div>\n<ul class=\"sectlevel1\">\n<li><a href=\"#_vert_x_discovery_backend_zookeeper\">Vert.x Discovery Backend - Zookeeper</a></li>\n<li><a href=\"#_using_the_zookeeper_backend\">Using the Zookeeper backend</a></li>\n<li><a href=\"#_configuration\">Configuration</a></li>\n<li><a href=\"#_how_are_stored_the_records\">How are stored the records</a></li>\n</ul>\n</div>","contents":"\n<div class=\"sect1\">\n<h2 id=\"_vert_x_discovery_backend_zookeeper\"><a class=\"anchor\" href=\"#_vert_x_discovery_backend_zookeeper\"></a>Vert.x Discovery Backend - Zookeeper</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>The service discovery has a plug-able backend using the <code><a href=\"../../apidocs/io/vertx/servicediscovery/spi/ServiceDiscoveryBackend.html\">ServiceDiscoveryBackend</a></code> SPI. This is an implementation of the SPI based\non Apache Zookeeper.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_using_the_zookeeper_backend\"><a class=\"anchor\" href=\"#_using_the_zookeeper_backend\"></a>Using the Zookeeper backend</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>To use the Zookeeper backend, add the following dependency to the <em>dependencies</em> section of your build\ndescriptor:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Maven (in your <code>pom.xml</code>):</p>\n</li>\n</ul>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-xml\" data-lang=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.vertx<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>vertx-service-discovery-backend-zookeeper<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>3.9.6<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span></code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Gradle (in your <code>build.gradle</code> file):</p>\n</li>\n</ul>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-groovy\" data-lang=\"groovy\">compile <span class=\"hljs-string\">&#x27;io.vertx:vertx-service-discovery-backend-zookeeper:3.9.6&#x27;</span></code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>Be aware that you can have only a single implementation of the SPI in your <em>classpath</em>. If none,\nthe default backend is used.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_configuration\"><a class=\"anchor\" href=\"#_configuration\"></a>Configuration</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>There is a single mandatory configuration attribute: <code>connection</code>. Connection is the Zookeeper connection <em>string</em>.</p>\n</div>\n<div class=\"paragraph\">\n<p>Here is an example:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-kotlin\" data-lang=\"kotlin\">ServiceDiscovery.create(vertx, ServiceDiscoveryOptions(\n  backendConfiguration = json {\n    obj(<span class=\"hljs-string\">&quot;connection&quot;</span> to <span class=\"hljs-string\">&quot;127.0.0.1:2181&quot;</span>)\n  }))</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>Additionally you can configure:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><code>maxRetries</code>: the number of connection attempt, 3 by default</p>\n</li>\n<li>\n<p><code>baseSleepTimeBetweenRetries</code>: the amount of milliseconds to wait between retries (exponential backoff strategy).\n1000 ms by default.</p>\n</li>\n<li>\n<p><code>connectionTimeoutMs</code>: the connection timeout in milliseconds. Defaults to 1000.</p>\n</li>\n<li>\n<p><code>canBeReadOnly</code> : whether or not the backend support the <em>read-only</em> mode (defaults to false)</p>\n</li>\n<li>\n<p><code>basePath</code>: the Zookeeper path in which the service records are stored. Default to <code>/services</code>.</p>\n</li>\n<li>\n<p><code>ephemeral</code>: whether or not the created nodes are ephemeral nodes (see\n<a href=\"https://zookeeper.apache.org/doc/r3.4.5/zookeeperOver.html#Nodes+and+ephemeral+nodes\" class=\"bare\">https://zookeeper.apache.org/doc/r3.4.5/zookeeperOver.html#Nodes+and+ephemeral+nodes</a>). <code>false</code> by default</p>\n</li>\n<li>\n<p><code>guaranteed</code>: whether or not to guarantee the node deletion even in case of failure. <code>false</code> by default</p>\n</li>\n</ul>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-kotlin\" data-lang=\"kotlin\">ServiceDiscovery.create(vertx, ServiceDiscoveryOptions(\n  backendConfiguration = json {\n    obj(\n      <span class=\"hljs-string\">&quot;connection&quot;</span> to <span class=\"hljs-string\">&quot;127.0.0.1:2181&quot;</span>,\n      <span class=\"hljs-string\">&quot;ephemeral&quot;</span> to <span class=\"hljs-literal\">true</span>,\n      <span class=\"hljs-string\">&quot;guaranteed&quot;</span> to <span class=\"hljs-literal\">true</span>,\n      <span class=\"hljs-string\">&quot;basePath&quot;</span> to <span class=\"hljs-string\">&quot;/services/my-backend&quot;</span>\n    )\n  }))</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_how_are_stored_the_records\"><a class=\"anchor\" href=\"#_how_are_stored_the_records\"></a>How are stored the records</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>The records are stored in individual nodes structured as follows:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code>basepath (/services/)\n  |\n  |- record 1 registration id =&gt; the record 1 is the data of this node\n  |- record 2 registration id =&gt; the record 2 is the data of this node</code></pre>\n</div>\n</div>\n</div>\n</div>","version":"3.9.6"},"__N_SSG":true}