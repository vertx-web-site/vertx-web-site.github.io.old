<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="description" content="Vert.x | Reactive applications on the JVM"/><meta name="robots" content="index,follow"/><link rel="shortcut icon" href="/favicons/favicon.ico"/><link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="48x48" href="/favicons/favicon-48x48.png"/><link rel="alternate" type="application/rss+xml" href="/feed/rss.xml"/><link rel="alternate" type="application/atom+xml" href="/feed/atom.xml"/><link rel="alternate" type="application/json" href="/feed/feed.json"/><title>Vert.x Circuit Breaker | <!-- -->Eclipse Vert.x<!-- --></title><meta name="next-head-count" content="13"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-a93aa46380b4694b.js" defer=""></script><script src="/_next/static/chunks/framework-81b9e9657f875d99.js" defer=""></script><script src="/_next/static/chunks/main-eb33b89c22079232.js" defer=""></script><script src="/_next/static/chunks/pages/_app-b65de3ecfe4346ec.js" defer=""></script><script src="/_next/static/chunks/61-dec5df0e40bc657e.js" defer=""></script><script src="/_next/static/chunks/619-d7a22a0a8627d5dc.js" defer=""></script><script src="/_next/static/chunks/629-c022341baf5a2a8d.js" defer=""></script><script src="/_next/static/chunks/74-60481b62b1bb65a9.js" defer=""></script><script src="/_next/static/chunks/361-368294ca7c0c9bdc.js" defer=""></script><script src="/_next/static/chunks/pages/docs/%5B%5B...slug%5D%5D-8992035060cd7ffc.js" defer=""></script><script src="/_next/static/TfCrH4GEYTYgoXJBLUTks/_buildManifest.js" defer=""></script><script src="/_next/static/TfCrH4GEYTYgoXJBLUTks/_ssgManifest.js" defer=""></script><script src="/_next/static/TfCrH4GEYTYgoXJBLUTks/_middlewareManifest.js" defer=""></script><style data-href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap">@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5vAA.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Me5g.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9vAA.woff) format('woff')}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmSU5fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu72xKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu5mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7mxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7WxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu7GxKKTU1Kvnz.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOmCnqEu92Fr1Mu4mxKKTU1Kg.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCRc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fABc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCBc4AMP6lbBP.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fBxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fCxc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fChc4AMP6lbBP.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto';font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/roboto/v29/KFOlCnqEu92Fr1MmEU9fBBc4AMP6lQ.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@300;400&display=swap">@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZKCA.woff) format('woff')}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-59Y.woff) format('woff')}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCkYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCAYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCgYb9lecyVC4A.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCcYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCsYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCoYb9lecyVC4A.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVi2ZhZI2eCN5jzbjEETS9weq8-33mZGCQYb9lecyU.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-19-7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-19a7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-1967DQk6YvNkeg.woff2) format('woff2');unicode-range:U+1F00-1FFF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-19G7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-1927DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-19y7DQk6YvNkeg.woff2) format('woff2');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Condensed';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotocondensed/v25/ieVl2ZhZI2eCN5jzbjEETS9weq8-19K7DQk6YvM.woff2) format('woff2');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style><style data-href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400&display=swap">@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v21/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vqPQA.woff) format('woff')}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v21/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_SeW-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0460-052F,U+1C80-1C88,U+20B4,U+2DE0-2DFF,U+A640-A69F,U+FE2E-FE2F}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v21/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_QOW-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0400-045F,U+0490-0491,U+04B0-04B1,U+2116}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v21/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_R-W-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0370-03FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v21/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_S-W-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0102-0103,U+0110-0111,U+0128-0129,U+0168-0169,U+01A0-01A1,U+01AF-01B0,U+1EA0-1EF9,U+20AB}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v21/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_SuW-AJi8SJQtQ4Y.woff) format('woff');unicode-range:U+0100-024F,U+0259,U+1E00-1EFF,U+2020,U+20A0-20AB,U+20AD-20CF,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:'Roboto Mono';font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/robotomono/v21/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vq_ROW-AJi8SJQt.woff) format('woff');unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+2000-206F,U+2074,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}</style></head><body data-build-time="2022-04-28T13:43:41.380Z" data-build-commit-id="37b17d3dda2ff43c48c7f67f570026da74e2be35" data-build-run-id="2239621594"><div id="__next"><main class="jsx-8eedb594ed1b4625 page docs"><header><div class="jsx-f705e145f931f504 navbar"><div class="jsx-f705e145f931f504 navbar-content container"><div class="jsx-f705e145f931f504 navbar-logo"><a class="jsx-f705e145f931f504" href="/"><img src="data:image/svg+xml,%3csvg version=&#x27;1.1&#x27; id=&#x27;Layer_1&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; viewBox=&#x27;0 0 1232.6 315.2&#x27; style=&#x27;enable-background:new 0 0 1232.6 315.2&#x27; xml:space=&#x27;preserve&#x27;%3e%3cstyle%3e.st0%7bfill:%23782a91%7d%3c/style%3e%3cpath d=&#x27;M120.9 214.2 190.5 0h52.3l-98.5 273.8H98.2L0 0h52.1l68.8 214.2zm291.2-62.6H299.6v84.2H431v38H252V0h177.7v38.4H299.6V114h112.5v37.6zm83.7-113.2H546c16.5.3 29 4.4 37.3 12.4 8.3 8 12.5 19.4 12.5 34 0 14-4.5 25.1-13.5 33.2-9 8.1-21.6 12.1-37.6 12.1h-27.1v24.2l86.1 119.5h51v-2.4l-77.2-106.7c24.9-5.5 43.3-21.7 52.6-35.9 8.2-12.6 13.3-27.7 13.3-46 0-26.8-8.6-47.4-25.8-61.5C600.5 7.1 576.1 0 544.5 0h-96.3v273.8h47.6&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1052.3 157.7-41.5 62.7 29.7 53.4h85.1z&#x27;/%3e%3ccircle class=&#x27;st0&#x27; cx=&#x27;827.9&#x27; cy=&#x27;274.7&#x27; r=&#x27;40.5&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1037 0-47.6 74.2L949 0h-84l85.3 135.8-67.1 105.7c5.7 9.5 9.1 20.5 9.2 32.4h50.1L1121.3 0H1037z&#x27;/%3e%3cpath d=&#x27;M763.5 273.8c.1-9.9 2.5-19.2 6.6-27.5V38.4h85.4V0H638.2v38.4h84.6v235.4h40.7zm414-266.9h-15.3v42.2h-8.5V6.9h-15.2V0h39v6.9zM1193 0l14.2 37.7L1221.3 0h11v49.1h-8.5V32.9l.8-21.7-14.5 37.9h-6.1l-14.5-37.8.8 21.6v16.2h-8.5V0h11.2z&#x27;/%3e%3c/svg%3e" alt="Vert.x Logo" class="jsx-f705e145f931f504"/></a></div><div class="jsx-f705e145f931f504 navbar-collapse-button"><span class="jsx-f705e145f931f504"></span><span class="jsx-f705e145f931f504"></span><span class="jsx-f705e145f931f504"></span></div><div class="jsx-f705e145f931f504 navbar-right"><div class="jsx-f705e145f931f504 navbar-menu"><span class="jsx-f705e145f931f504 navbar-menu-item with-drop-down"><div class="jsx-6650573c8f14945d dropdown"><a class="jsx-6650573c8f14945d dropdown-title">Start<!-- --><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="jsx-6650573c8f14945d dropdown-menu"><a class="jsx-f705e145f931f504" href="/introduction-to-vertx-and-reactive/"><li class="jsx-400ec7965926e858 dropdown-item">Intro to reactive<!-- --></li></a><a class="jsx-f705e145f931f504" href="/get-started/"><li class="jsx-400ec7965926e858 dropdown-item">Get started<!-- --></li></a><a href="https://start.vertx.io/" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">App generator <!-- --><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="jsx-f705e145f931f504 navbar-menu-item" href="/docs/">Docs</a><span class="jsx-f705e145f931f504 navbar-menu-item with-drop-down"><div class="jsx-6650573c8f14945d dropdown"><a class="jsx-6650573c8f14945d dropdown-title">Resources<!-- --><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="jsx-6650573c8f14945d dropdown-menu"><a class="jsx-f705e145f931f504" href="/faq/"><li class="jsx-400ec7965926e858 dropdown-item">FAQ<!-- --></li></a><a class="jsx-f705e145f931f504" href="/channels/"><li class="jsx-400ec7965926e858 dropdown-item">Channels<!-- --></li></a><a href="https://how-to.vertx.io/" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">How-Toâ€™s <!-- --><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a><a href="https://github.com/vert-x3/vertx-eventbus-bridge-clients" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">EventBus Bridge Clients <!-- --><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a><a href="https://github.com/vert-x3/advanced-vertx-guide" target="_blank" rel="noreferrer" class="jsx-f705e145f931f504"><li class="jsx-400ec7965926e858 dropdown-item">Advanced Vert.x Guide <!-- --><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="external-link-icon"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg></li></a></ul></div></span><a class="jsx-f705e145f931f504 navbar-menu-item" href="/blog/">Blog</a><a class="jsx-f705e145f931f504 navbar-menu-item" href="/community/">Community</a></div><div class="jsx-f705e145f931f504 navbar-social"><span class="jsx-75cbc16d79a176fb "><a href="https://github.com/vert-x3/vertx-awesome" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="List of awesome Vert.x projects"><title></title><path d="M24 11.438l-6.154-5.645-.865.944 5.128 4.7H1.895l5.128-4.705-.865-.943-6.154 5.649H0v3.72c0 1.683 1.62 3.053 3.61 3.053h3.795c1.99 0 3.61-1.37 3.61-3.051v-2.446h1.97v2.446c0 1.68 1.62 3.051 3.61 3.051h3.794c1.99 0 3.61-1.37 3.61-3.051v-3.721z"></path></svg></a></span><div class="jsx-75cbc16d79a176fb tooltip">Awesome Vert.x<!-- --><div data-popper-arrow="true" class="jsx-75cbc16d79a176fb tooltip-arrow"></div></div><span class="jsx-75cbc16d79a176fb "><a href="https://stackoverflow.com/questions/tagged/vert.x" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Stack Overflow questions related to Vert.x"><title></title><path d="M15.725 0l-1.72 1.277 6.39 8.588 1.716-1.277L15.725 0zm-3.94 3.418l-1.369 1.644 8.225 6.85 1.369-1.644-8.225-6.85zm-3.15 4.465l-.905 1.94 9.702 4.517.904-1.94-9.701-4.517zm-1.85 4.86l-.44 2.093 10.473 2.201.44-2.092-10.473-2.203zM1.89 15.47V24h19.19v-8.53h-2.133v6.397H4.021v-6.396H1.89zm4.265 2.133v2.13h10.66v-2.13H6.154Z"></path></svg></a></span><div class="jsx-75cbc16d79a176fb tooltip">Stack Overflow<!-- --><div data-popper-arrow="true" class="jsx-75cbc16d79a176fb tooltip-arrow"></div></div><span class="jsx-75cbc16d79a176fb "><a href="https://www.youtube.com/channel/UCGN6L3tRhs92Uer3c6VxOSA" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="YouTube channel of Vert.x"><title></title><path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"></path></svg></a></span><div class="jsx-75cbc16d79a176fb tooltip">YouTube<!-- --><div data-popper-arrow="true" class="jsx-75cbc16d79a176fb tooltip-arrow"></div></div><span class="jsx-75cbc16d79a176fb "><a href="https://discord.gg/KzEMwP2" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="Eclipse Vert.x channel on Discord"><title></title><path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.946 2.4189-2.1568 2.4189Z"></path></svg></a></span><div class="jsx-75cbc16d79a176fb tooltip">Discord<!-- --><div data-popper-arrow="true" class="jsx-75cbc16d79a176fb tooltip-arrow"></div></div><span class="jsx-75cbc16d79a176fb "><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx" target="_blank" rel="noopener noreferrer" class="jsx-f705e145f931f504 navbar-social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24" aria-label="A Google group for Vert.x users"><title></title><path d="M.92 3.332c-.776 0-1.216.67-.692 1.383l2.537 4.403v7.86c0 2.013 1.467 3.69 3.459 3.69H20.31a3.75 3.75 0 003.69-3.69V7.043a3.723 3.723 0 00-3.668-3.71zm5.786 3.71H20.1c.587 0 1.153.357 1.153.923 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.923 1.153-.923zm0 3.69H20.1c.587 0 1.153.356 1.153.922 0 .566-.566.922-1.153.922H6.706c-.587 0-1.153-.356-1.153-.922 0-.566.566-.922 1.153-.922zm-.021 3.71h9.705c.587 0 1.153.356 1.153.922 0 .566-.566.923-1.153.923H6.685c-.587 0-1.153-.357-1.153-.923 0-.566.566-.922 1.153-.922Z"></path></svg></a></span><div class="jsx-75cbc16d79a176fb tooltip">Vert.x User Group<!-- --><div data-popper-arrow="true" class="jsx-75cbc16d79a176fb tooltip-arrow"></div></div></div></div></div></div></header><div class="jsx-8eedb594ed1b4625 page-content docs-content"><div class="jsx-8eedb594ed1b4625 container"><div class="jsx-8eedb594ed1b4625 docs-content-wrapper"><aside class="jsx-8eedb594ed1b4625 "><div class="jsx-8eedb594ed1b4625 docs-content-wrapper-sidebar"><div class="jsx-d1843944f2d67b search-panel"><div class="jsx-b8b24b20b287542e search"><input type="text" disabled="" class="jsx-b8b24b20b287542e autosuggest"/><input type="text" placeholder="Search..." class="jsx-b8b24b20b287542e" value=""/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="search-icon-delete"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg></div><ul class="jsx-4a39f0db74e84d2d search-results"></ul><div class="jsx-4a39f0db74e84d2d search-results-none">No results.</div></div><div class="jsx-8eedb594ed1b4625 docs-content-toc"><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_using_the_vert_x_circuit_breaker">Using the vert.x circuit breaker</a></li>
<li><a href="#_using_the_circuit_breaker">Using the circuit breaker</a></li>
<li><a href="#_retries">Retries</a></li>
<li><a href="#_callbacks">Callbacks</a></li>
<li><a href="#_event_bus_notification">Event bus notification</a></li>
<li><a href="#_the_half_open_state">The half-open state</a></li>
<li><a href="#_reported_exceptions">Reported exceptions</a></li>
<li><a href="#_pushing_circuit_breaker_metrics_to_the_hystrix_dashboard">Pushing circuit breaker metrics to the Hystrix Dashboard</a></li>
</ul>
</div></div></div></aside><div class="jsx-8eedb594ed1b4625 docs-content-sidebar-toggle"><div style="position:relative" class="jsx-8eedb594ed1b4625"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-x"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg></div></div><div class="jsx-8eedb594ed1b4625 docs-content-inner"><div class="jsx-8eedb594ed1b4625 docs-content-metadata"><div class="jsx-8eedb594ed1b4625 docs-content-metadata-left"><div class="jsx-8eedb594ed1b4625"><a href="/docs/apidocs" class="jsx-8eedb594ed1b4625"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg> API<!-- --></a></div><span class="jsx-8eedb594ed1b4625 docs-content-metadata-version"><div class="jsx-6650573c8f14945d dropdown"><a class="jsx-6650573c8f14945d dropdown-title">v4.2.7<!-- --><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg></a><ul class="jsx-6650573c8f14945d dropdown-menu align-right"></ul></div></span></div></div><div class="jsx-8eedb594ed1b4625"><h1>Vert.x Circuit Breaker</h1>

<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x Circuit Breaker is an implementation of the Circuit Breaker <em>pattern</em> for Vert.x. It keeps track of the
number of failures and <em>opens the circuit</em> when a threshold is reached. Optionally, a fallback is executed.</p>
</div>
<div class="paragraph">
<p>Supported failures are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>failures reported by your code in a <code><a href="../../apidocs/io/vertx/core/Future.html">Future</a></code></p>
</li>
<li>
<p>exception thrown by your code</p>
</li>
<li>
<p>uncompleted futures (timeout)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Operations guarded by a circuit breaker are intended to be non-blocking and asynchronous in order to benefit from
the Vert.x execution model.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_vert_x_circuit_breaker"><a class="anchor" href="#_using_the_vert_x_circuit_breaker"></a>Using the vert.x circuit breaker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use the Vert.x Circuit Breaker, add the following dependency to the <em>dependencies</em> section of your build
descriptor:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maven (in your <code>pom.xml</code>):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.vertx<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>vertx-circuit-breaker<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
 <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.9.8<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle (in your <code>build.gradle</code> file):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">compile <span class="hljs-string">&#x27;io.vertx:vertx-circuit-breaker:3.9.8&#x27;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_circuit_breaker"><a class="anchor" href="#_using_the_circuit_breaker"></a>Using the circuit breaker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use the circuit breaker you need to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a circuit breaker, with the configuration you want (timeout, number of failure before opening the circuit)</p>
</li>
<li>
<p>Execute some code using the breaker</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Important</strong>: Don&#8217;t recreate a circuit breaker on every call. A circuit breaker is a staful entity. It is recommended
to store the circuit breaker instance in a field.</p>
</div>
<div class="paragraph">
<p>Here is an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy"><span class="hljs-keyword">def</span> breaker = CircuitBreaker.create(<span class="hljs-string">&quot;my-circuit-breaker&quot;</span>, vertx, [
  <span class="hljs-symbol">maxFailures:</span><span class="hljs-number">5</span>,
  <span class="hljs-symbol">timeout:</span><span class="hljs-number">2000</span>,
  <span class="hljs-symbol">fallbackOnFailure:</span><span class="hljs-literal">true</span>,
  <span class="hljs-symbol">resetTimeout:</span><span class="hljs-number">10000</span>
])

<span class="hljs-comment">// ---</span>
<span class="hljs-comment">// Store the circuit breaker in a field and access it as follows</span>
<span class="hljs-comment">// ---</span>

breaker.execute({ future -&gt;
  <span class="hljs-comment">// some code executing with the breaker</span>
  <span class="hljs-comment">// the code reports failures or success on the given future.</span>
  <span class="hljs-comment">// if this future is marked as failed, the breaker increased the</span>
  <span class="hljs-comment">// number of failures</span>
}).setHandler({ ar -&gt;
  <span class="hljs-comment">// Get the operation result.</span>
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>The executed block receives a <code><a href="../../apidocs/io/vertx/core/Future.html">Future</a></code> object as parameter, to denote the
success or failure of the operation as well as the result. For example in the following example, the result is the
output of a REST endpoint invocation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy"><span class="hljs-keyword">def</span> breaker = CircuitBreaker.create(<span class="hljs-string">&quot;my-circuit-breaker&quot;</span>, vertx, [
  <span class="hljs-symbol">maxFailures:</span><span class="hljs-number">5</span>,
  <span class="hljs-symbol">timeout:</span><span class="hljs-number">2000</span>
])

<span class="hljs-comment">// ---</span>
<span class="hljs-comment">// Store the circuit breaker in a field and access it as follows</span>
<span class="hljs-comment">// ---</span>

breaker.execute({ future -&gt;
  vertx.createHttpClient().getNow(<span class="hljs-number">8080</span>, <span class="hljs-string">&quot;localhost&quot;</span>, <span class="hljs-string">&quot;/&quot;</span>, { response -&gt;
    <span class="hljs-keyword">if</span> (response.statusCode() != <span class="hljs-number">200</span>) {
      future.fail(<span class="hljs-string">&quot;HTTP error&quot;</span>)
    } <span class="hljs-keyword">else</span> {
      response.exceptionHandler(future.&amp;fail).bodyHandler({ buffer -&gt;
        future.complete(buffer.toString())
      })
    }
  })
}).setHandler({ ar -&gt;
  <span class="hljs-comment">// Do something with the result</span>
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of the operation is provided using the:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>returned <code><a href="../../apidocs/io/vertx/core/Future.html">Future</a></code> when calling <code>execute</code> methods</p>
</li>
<li>
<p>provided <code><a href="../../apidocs/io/vertx/core/Future.html">Future</a></code> when calling the <code>executeAndReport</code> methods</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Optionally, you can provide a fallback which is executed when the circuit is open:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy"><span class="hljs-keyword">def</span> breaker = CircuitBreaker.create(<span class="hljs-string">&quot;my-circuit-breaker&quot;</span>, vertx, [
  <span class="hljs-symbol">maxFailures:</span><span class="hljs-number">5</span>,
  <span class="hljs-symbol">timeout:</span><span class="hljs-number">2000</span>
])

<span class="hljs-comment">// ---</span>
<span class="hljs-comment">// Store the circuit breaker in a field and access it as follows</span>
<span class="hljs-comment">// ---</span>

breaker.executeWithFallback({ future -&gt;
  vertx.createHttpClient().getNow(<span class="hljs-number">8080</span>, <span class="hljs-string">&quot;localhost&quot;</span>, <span class="hljs-string">&quot;/&quot;</span>, { response -&gt;
    <span class="hljs-keyword">if</span> (response.statusCode() != <span class="hljs-number">200</span>) {
      future.fail(<span class="hljs-string">&quot;HTTP error&quot;</span>)
    } <span class="hljs-keyword">else</span> {
      response.exceptionHandler(future.&amp;fail).bodyHandler({ buffer -&gt;
        future.complete(buffer.toString())
      })
    }
  })
}, { v -&gt;
  <span class="hljs-comment">// Executed when the circuit is opened</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Hello&quot;</span>
}).setHandler({ ar -&gt;
  <span class="hljs-comment">// Do something with the result</span>
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>The fallback is called whenever the circuit is open, or if the
<code><a href="../../apidocs/io/vertx/circuitbreaker/CircuitBreakerOptions.html#isFallbackOnFailure--">isFallbackOnFailure</a></code> is enabled. When a fallback is
set, the result is using the output of the fallback function. The fallback function takes as parameter a
<code><a href="../../apidocs/java/lang/Throwable.html">Throwable</a></code> object and returns an object of the expected type.</p>
</div>
<div class="paragraph">
<p>The fallback can also be set on the <code><a href="../../apidocs/io/vertx/circuitbreaker/CircuitBreaker.html">CircuitBreaker</a></code> object directly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy"><span class="hljs-keyword">def</span> breaker = CircuitBreaker.create(<span class="hljs-string">&quot;my-circuit-breaker&quot;</span>, vertx, [
  <span class="hljs-symbol">maxFailures:</span><span class="hljs-number">5</span>,
  <span class="hljs-symbol">timeout:</span><span class="hljs-number">2000</span>
]).fallback({ v -&gt;
  <span class="hljs-comment">// Executed when the circuit is opened.</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;hello&quot;</span>
})

breaker.execute({ future -&gt;
  vertx.createHttpClient().getNow(<span class="hljs-number">8080</span>, <span class="hljs-string">&quot;localhost&quot;</span>, <span class="hljs-string">&quot;/&quot;</span>, { response -&gt;
    <span class="hljs-keyword">if</span> (response.statusCode() != <span class="hljs-number">200</span>) {
      future.fail(<span class="hljs-string">&quot;HTTP error&quot;</span>)
    } <span class="hljs-keyword">else</span> {
      response.exceptionHandler(future.&amp;fail).bodyHandler({ buffer -&gt;
        future.complete(buffer.toString())
      })
    }
  })
})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_retries"><a class="anchor" href="#_retries"></a>Retries</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can also specify how often the circuit breaker should try your code before failing with
<code><a href="../../apidocs/io/vertx/circuitbreaker/CircuitBreakerOptions.html#setMaxRetries-int-">setMaxRetries</a></code>.
If you set this to something higher than 0 your code gets executed several times before finally failing
in the last execution. If the code succeeded in one of the retries your handler gets notified and any
retries left are skipped. Retries are only supported when the circuit is closed.</p>
</div>
<div class="paragraph">
<p>Notice that if you set <code>maxRetries</code> to 2 for instance, your operation may be called 3 times: the initial attempt
and 2 retries.</p>
</div>
<div class="paragraph">
<p>By default the timeout between retries is set to 0 which means that retries will be executed one after another without
any delay. This, however, will result in increased load on the called service and may delay it&#8217;s recovery.
In order to mitigate this problem it is recommended to execute retries with delays. <code><a href="../../apidocs/io/vertx/circuitbreaker/CircuitBreaker.html#retryPolicy-java.util.function.Function-">retryPolicy</a></code>
method can be used to specify retry policy. Retry policy is a function which receives retry count as single argument
and returns timeout in milliseconds before retry is executed and allows to implement a more complex policy, e.g.
exponential backoff with jitter. Below is an example of retry timeout which grows linearly with each retry count:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy"><span class="hljs-keyword">def</span> breaker = CircuitBreaker.create(<span class="hljs-string">&quot;my-circuit-breaker&quot;</span>, vertx, [
  <span class="hljs-symbol">maxFailures:</span><span class="hljs-number">5</span>,
  <span class="hljs-symbol">maxRetries:</span><span class="hljs-number">5</span>,
  <span class="hljs-symbol">timeout:</span><span class="hljs-number">2000</span>
]).openHandler({ v -&gt;
  println(<span class="hljs-string">&quot;Circuit opened&quot;</span>)
}).closeHandler({ v -&gt;
  println(<span class="hljs-string">&quot;Circuit closed&quot;</span>)
}).retryPolicy({ retryCount -&gt;
  retryCount * <span class="hljs-number">100</span>L
})

breaker.execute({ future -&gt;
  vertx.createHttpClient().getNow(<span class="hljs-number">8080</span>, <span class="hljs-string">&quot;localhost&quot;</span>, <span class="hljs-string">&quot;/&quot;</span>, { response -&gt;
    <span class="hljs-keyword">if</span> (response.statusCode() != <span class="hljs-number">200</span>) {
      future.fail(<span class="hljs-string">&quot;HTTP error&quot;</span>)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// Do something with the response</span>
      future.complete()
    }
  })
})</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_callbacks"><a class="anchor" href="#_callbacks"></a>Callbacks</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can also configures callbacks invoked when the circuit is opened or closed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy"><span class="hljs-keyword">def</span> breaker = CircuitBreaker.create(<span class="hljs-string">&quot;my-circuit-breaker&quot;</span>, vertx, [
  <span class="hljs-symbol">maxFailures:</span><span class="hljs-number">5</span>,
  <span class="hljs-symbol">timeout:</span><span class="hljs-number">2000</span>
]).openHandler({ v -&gt;
  println(<span class="hljs-string">&quot;Circuit opened&quot;</span>)
}).closeHandler({ v -&gt;
  println(<span class="hljs-string">&quot;Circuit closed&quot;</span>)
})

breaker.execute({ future -&gt;
  vertx.createHttpClient().getNow(<span class="hljs-number">8080</span>, <span class="hljs-string">&quot;localhost&quot;</span>, <span class="hljs-string">&quot;/&quot;</span>, { response -&gt;
    <span class="hljs-keyword">if</span> (response.statusCode() != <span class="hljs-number">200</span>) {
      future.fail(<span class="hljs-string">&quot;HTTP error&quot;</span>)
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// Do something with the response</span>
      future.complete()
    }
  })
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also be notified when the circuit breaker decides to attempt to reset (half-open state). You can register
such a callback with <code><a href="../../apidocs/io/vertx/circuitbreaker/CircuitBreaker.html#halfOpenHandler-io.vertx.core.Handler-">halfOpenHandler</a></code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_event_bus_notification"><a class="anchor" href="#_event_bus_notification"></a>Event bus notification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Every time the circuit state changes, an event is published on the event bus. The address on which the events are
sent is configurable with
<code><a href="../../apidocs/io/vertx/circuitbreaker/CircuitBreakerOptions.html#setNotificationAddress-java.lang.String-">setNotificationAddress</a></code>. If <code>null</code> is
passed to this method, the notifications are disabled. By default, the used address is <code>vertx.circuit-breaker</code>.</p>
</div>
<div class="paragraph">
<p>Each event contains a Json Object with:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>state</code> : the new circuit breaker state (<code>OPEN</code>, <code>CLOSED</code>, <code>HALF_OPEN</code>)</p>
</li>
<li>
<p><code>name</code> : the name of the circuit breaker</p>
</li>
<li>
<p><code>failures</code> : the number of failures</p>
</li>
<li>
<p><code>node</code> : the identifier of the node (<code>local</code> if Vert.x is not running in cluster mode)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_half_open_state"><a class="anchor" href="#_the_half_open_state"></a>The half-open state</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the circuit is "open", calls to the circuit breaker fail immediately, without any attempt to execute the real
operation. After a suitable amount of time (configured from
<code><a href="../../apidocs/io/vertx/circuitbreaker/CircuitBreakerOptions.html#setResetTimeout-long-">setResetTimeout</a></code>, the circuit breaker decides that the
operation has a chance of succeeding, so it goes into the <code>half-open</code> state. In this state, the next call to the
circuit breaker is allowed to execute the dangerous operation. Should the call succeed, the circuit breaker resets
and returns to the <code>closed</code> state, ready for more routine operation. If this trial call fails, however, the circuit
breaker returns to the <code>open</code> state until another timeout elapses.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reported_exceptions"><a class="anchor" href="#_reported_exceptions"></a>Reported exceptions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The fallback receives a:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code><a href="../../apidocs/io/vertx/circuitbreaker/OpenCircuitException.html">OpenCircuitException</a></code> when the circuit breaker is opened</p>
</li>
<li>
<p><code><a href="../../apidocs/io/vertx/circuitbreaker/TimeoutException.html">TimeoutException</a></code> when the operation timed out</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_pushing_circuit_breaker_metrics_to_the_hystrix_dashboard"><a class="anchor" href="#_pushing_circuit_breaker_metrics_to_the_hystrix_dashboard"></a>Pushing circuit breaker metrics to the Hystrix Dashboard</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Netflix Hystrix comes with a dashboard to present the current state of the circuit breakers. The Vert.x circuit
breakers can publish their metrics in order to be consumed by this Hystrix Dashboard. The Hystrix dashboard requires
a SSE stream sending the metrics. This stream is provided by the
<code><a href="../../apidocs/io/vertx/circuitbreaker/HystrixMetricHandler.html">HystrixMetricHandler</a></code> Vert.x Web Handler:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy"><span class="hljs-comment">// Create the circuit breaker as usual.</span>
<span class="hljs-keyword">def</span> breaker = CircuitBreaker.create(<span class="hljs-string">&quot;my-circuit-breaker&quot;</span>, vertx)
<span class="hljs-keyword">def</span> breaker2 = CircuitBreaker.create(<span class="hljs-string">&quot;my-second-circuit-breaker&quot;</span>, vertx)

<span class="hljs-comment">// Create a Vert.x Web router</span>
<span class="hljs-keyword">def</span> router = Router.router(vertx)
<span class="hljs-comment">// Register the metric handler</span>
router.get(<span class="hljs-string">&quot;/hystrix-metrics&quot;</span>).handler(HystrixMetricHandler.create(vertx))

<span class="hljs-comment">// Create the HTTP server using the router to dispatch the requests</span>
vertx.createHttpServer().requestHandler(router).listen(<span class="hljs-number">8080</span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the Hystrix Dashboard, configure the stream url like: <code><a href="http://localhost:8080/metrics" class="bare">http://localhost:8080/metrics</a></code>. The dashboard now consumes
the metrics from the Vert.x circuit breakers.</p>
</div>
<div class="paragraph">
<p>Notice that the metrics are collected by the Vert.x Web handler using the event bus notifications. If you don&#8217;t use
the default notification address, you need to pass it when creating the metrics handler.</p>
</div>
</div>
</div></div></div></div></div></div><footer class="jsx-3acb63b44722e9f1"><div class="jsx-3acb63b44722e9f1 container"><div class="jsx-3acb63b44722e9f1 footer-nav-section"><div class="jsx-3acb63b44722e9f1 footer-nav-list footer-logo"><a class="jsx-3acb63b44722e9f1" href="/"><img src="data:image/svg+xml,%3csvg version=&#x27;1.1&#x27; id=&#x27;Layer_1&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; viewBox=&#x27;0 0 1232.6 315.2&#x27; style=&#x27;enable-background:new 0 0 1232.6 315.2&#x27; xml:space=&#x27;preserve&#x27;%3e%3cstyle%3e.st0%7bfill:%23782a91%7d%3c/style%3e%3cpath d=&#x27;M120.9 214.2 190.5 0h52.3l-98.5 273.8H98.2L0 0h52.1l68.8 214.2zm291.2-62.6H299.6v84.2H431v38H252V0h177.7v38.4H299.6V114h112.5v37.6zm83.7-113.2H546c16.5.3 29 4.4 37.3 12.4 8.3 8 12.5 19.4 12.5 34 0 14-4.5 25.1-13.5 33.2-9 8.1-21.6 12.1-37.6 12.1h-27.1v24.2l86.1 119.5h51v-2.4l-77.2-106.7c24.9-5.5 43.3-21.7 52.6-35.9 8.2-12.6 13.3-27.7 13.3-46 0-26.8-8.6-47.4-25.8-61.5C600.5 7.1 576.1 0 544.5 0h-96.3v273.8h47.6&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1052.3 157.7-41.5 62.7 29.7 53.4h85.1z&#x27;/%3e%3ccircle class=&#x27;st0&#x27; cx=&#x27;827.9&#x27; cy=&#x27;274.7&#x27; r=&#x27;40.5&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;m1037 0-47.6 74.2L949 0h-84l85.3 135.8-67.1 105.7c5.7 9.5 9.1 20.5 9.2 32.4h50.1L1121.3 0H1037z&#x27;/%3e%3cpath d=&#x27;M763.5 273.8c.1-9.9 2.5-19.2 6.6-27.5V38.4h85.4V0H638.2v38.4h84.6v235.4h40.7zm414-266.9h-15.3v42.2h-8.5V6.9h-15.2V0h39v6.9zM1193 0l14.2 37.7L1221.3 0h11v49.1h-8.5V32.9l.8-21.7-14.5 37.9h-6.1l-14.5-37.8.8 21.6v16.2h-8.5V0h11.2z&#x27;/%3e%3c/svg%3e" alt="Vert.x Logo" class="jsx-3acb63b44722e9f1"/></a></div><div class="jsx-3acb63b44722e9f1 footer-nav-list"><h5 class="jsx-3acb63b44722e9f1">Eclipse Vert.x</h5><ul class="jsx-3acb63b44722e9f1 "><li class="jsx-3acb63b44722e9f1"><a class="jsx-3acb63b44722e9f1 navbar-menu-item" href="/docs/">Docs</a></li><li class="jsx-3acb63b44722e9f1"><a class="jsx-3acb63b44722e9f1" href="/download/">Download</a></li><li class="jsx-3acb63b44722e9f1"><a class="jsx-3acb63b44722e9f1" href="/blog/">Blog</a></li><li class="jsx-3acb63b44722e9f1"><a class="jsx-3acb63b44722e9f1" href="/community/">Community</a></li><li class="jsx-3acb63b44722e9f1"><a href="https://github.com/eclipse-vertx/vert.x" class="jsx-3acb63b44722e9f1">GitHub</a></li></ul></div><div class="jsx-3acb63b44722e9f1 footer-nav-list"><h5 class="jsx-3acb63b44722e9f1">Resources</h5><ul class="jsx-3acb63b44722e9f1 "><li class="jsx-3acb63b44722e9f1"><a class="jsx-3acb63b44722e9f1" href="/faq/">FAQ</a></li><li class="jsx-3acb63b44722e9f1"><a class="jsx-3acb63b44722e9f1" href="/channels/">Channels</a></li><li class="jsx-3acb63b44722e9f1"><a href="https://how-to.vertx.io/" class="jsx-3acb63b44722e9f1">How-Toâ€™s</a></li><li class="jsx-3acb63b44722e9f1"><a href="https://start.vertx.io/" class="jsx-3acb63b44722e9f1">App Generator</a></li><li class="jsx-3acb63b44722e9f1"><a href="/.well-known/security.txt" class="jsx-3acb63b44722e9f1">security.txt</a></li></ul></div><div class="jsx-3acb63b44722e9f1 footer-nav-list"><h5 class="jsx-3acb63b44722e9f1">Eclipse</h5><ul class="jsx-3acb63b44722e9f1 "><li class="jsx-3acb63b44722e9f1"><a href="https://www.eclipse.org/" class="jsx-3acb63b44722e9f1">Eclipse Foundation</a></li><li class="jsx-3acb63b44722e9f1"><a href="https://www.eclipse.org/legal/privacy.php" class="jsx-3acb63b44722e9f1">Privacy Policy</a></li><li class="jsx-3acb63b44722e9f1"><a href="https://www.eclipse.org/legal/termsofuse.php" class="jsx-3acb63b44722e9f1">Terms of Use</a></li><li class="jsx-3acb63b44722e9f1"><a href="https://www.eclipse.org/legal/copyright.php" class="jsx-3acb63b44722e9f1">Copyright Agent</a></li><li class="jsx-3acb63b44722e9f1"><a href="https://www.eclipse.org/legal/" class="jsx-3acb63b44722e9f1">Legal Resources</a></li></ul></div></div><div class="jsx-3acb63b44722e9f1 footer-copyright"><div class="jsx-3acb63b44722e9f1 footer-copyright-remarks">Â© <!-- -->2022<!-- --> Eclipse Vert.xâ„¢<!-- --><br class="jsx-3acb63b44722e9f1"/>Eclipse Vert.xâ„¢ is open source and dual-licensed under the <!-- --><a href="https://creativecommons.org/licenses/by-sa/3.0/" target="_blank" rel="noopener noreferrer" class="jsx-3acb63b44722e9f1">Eclipse Public License 2.0</a> and the <!-- --><a href="https://www.apache.org/licenses/LICENSE-2.0.html" target="_blank" rel="noopener noreferrer" class="jsx-3acb63b44722e9f1">Apache License 2.0</a>. <!-- --><br class="jsx-3acb63b44722e9f1 footer-copyright-break"/>Website design by <!-- --><a href="https://michelkraemer.com" target="_blank" rel="noopener noreferrer" class="jsx-3acb63b44722e9f1">Michel KrÃ¤mer</a>.<!-- --></div><div class="jsx-3acb63b44722e9f1 footer-copyright-eclipse-logo"><a href="https://www.eclipse.org/" target="_blank" rel="noopener noreferrer" class="jsx-3acb63b44722e9f1"><img src="data:image/svg+xml,%3csvg version=&#x27;1.1&#x27; id=&#x27;Layer_1&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; x=&#x27;0&#x27; y=&#x27;0&#x27; viewBox=&#x27;0 0 281.3 91.1&#x27; style=&#x27;enable-background:new 0 0 281.3 91.1&#x27; xml:space=&#x27;preserve&#x27;%3e%3cstyle%3e.st0%7bfill:%23f79422%7d.st1%7bfill:%233d3c3b%7d%3c/style%3e%3cg id=&#x27;Layer_1_1_&#x27;%3e%3cpath class=&#x27;st0&#x27; d=&#x27;M265.7 84 257 73h-2.7v17.7h3.3v-12l9.3 12h2.1V73h-3.3v11zm-32.4-8.3c4.2 0 5.8 3.3 5.8 6.3s-1.6 6-5.8 6-5.7-3.1-5.8-6 1.7-6.3 5.8-6.3zm0-3c-6.1 0-9.1 4.7-9.1 9.3 0 4.7 2.9 9.1 9.1 9.1s9-4.6 9.1-9.2-3-9.2-9.1-9.2zm-21.2 18V73h-3.3v17.7h3.3zm-23.6 0h3.3V76h5.6v-3h-14.6v3h5.6l.1 14.7zm-18.9-6.5H163l3.3-7.6 3.3 7.6zm2.8 6.5h3.6L168.2 73h-3.6l-8 17.7h3.6l1.5-3.3h9.3l1.4 3.3zm-38-14.6h3.6c3.9 0 5.5 2.8 5.5 5.5.1 2.8-1.5 5.8-5.5 5.8h-3.6V76.1zm3.7-3.1h-6.9v17.7h6.9c6.2 0 8.9-4.5 8.9-9s-2.8-8.7-8.9-8.7zm-22.4 11L107 73h-2.7v17.7h3.3v-12l9.3 12h2.1V73h-3.3v11zM88.2 73v10.2c0 3-1.6 4.9-4.3 4.9s-4.6-1.7-4.6-4.9V73H76v10.1c0 5.3 3.6 7.9 7.9 7.9 4.4 0 7.7-2.7 7.7-7.9V73h-3.4zm-33 2.7c4.2 0 5.8 3.3 5.8 6.3s-1.6 6-5.8 6-5.7-3.1-5.8-6 1.7-6.3 5.8-6.3zm0-3c-6.1 0-9.1 4.7-9.1 9.3s2.9 9.1 9.1 9.1 9-4.6 9.1-9.2-3-9.2-9.1-9.2zm-29.7 18v-6.5h8.9v-3.1h-8.9v-4.8h9.4V73H22.2v17.6h3.3z&#x27;/%3e%3cpath class=&#x27;st1&#x27; d=&#x27;M269.4 54.4h-22.2v-8.9h21.4v-6.9h-21.4v-9.1h22.2v-7.2h-29.6v39.5h29.6v-7.4zm-40-25.6c-3-6.1-9.4-7.8-15.5-7.8-7.3 0-15.3 3.4-15.3 11.5 0 8.9 7.4 11 15.5 12 5.2.6 9.1 2.1 9.1 5.8 0 4.3-4.4 5.9-9.1 5.9s-9.4-1.9-11.1-6.3l-6.2 3.2c2.9 7.2 9.1 9.7 17.2 9.7 8.8 0 16.6-3.8 16.6-12.6 0-9.4-7.7-11.6-15.9-12.6-4.7-.6-8.8-1.5-8.8-5 0-2.9 2.6-5.2 8.2-5.2 4.3 0 8 2.2 9.4 4.4l5.9-3zM176 22.2c-6.2-.1-12.4 0-18.6 0v39.5h7.4V50.1H176c19.4 0 19.4-27.9 0-27.9zm-11.1 7.1H176c9.5 0 9.5 14 0 14h-11.2l.1-14zm-18 32.5V22.2h-7.4v39.5l7.4.1zm-44-39.6v39.5h27.7v-6.9h-20.3V22.2h-7.4zM90.7 51.7c-2.7 2.5-6.2 4-9.9 4-9.8 0-13.5-6.8-13.6-13.4s4.1-13.7 13.6-13.7c3.5-.1 7 1.3 9.5 3.7l5-4.8c-3.8-3.9-9.1-6-14.5-6-14.3 0-21 10.5-20.9 20.8s6.3 20.3 20.9 20.3c5.6.1 11-2 15-5.9l-5.1-5zm-39 2.7H29.5v-8.9h21.4v-6.9H29.5v-9.1h22.2v-7.2H22.2v39.5h29.6l-.1-7.4z&#x27;/%3e%3cpath class=&#x27;st0&#x27; d=&#x27;M9.8 18.2C18.8 4.1 36.9-.8 52.1 6l-1-.7C35.7-4.6 15.2-.1 5.3 15.3s-5.4 35.9 10 45.8l1.1.6C3.8 50.8.8 32.3 9.8 18.2z&#x27;/%3e%3cpath class=&#x27;st1&#x27; d=&#x27;M272.2 26.1c0-2.5 2.1-4.6 4.6-4.6 2.5 0 4.6 2.1 4.6 4.6 0 2.5-2.1 4.6-4.6 4.6-2.6 0-4.6-2.1-4.6-4.6zm8.6 0c0-2.2-1.8-4.1-4-4.1s-4.1 1.8-4.1 4.1c0 2.2 1.7 4 3.9 4.1h.1c2.3 0 4.1-1.8 4.1-4.1zm-6-2.5h2.3c1.1 0 1.9.5 1.9 1.6 0 .7-.4 1.3-1.1 1.5l1.2 1.7h-1.4l-1-1.5h-.7v1.5h-1.1l-.1-4.8zm2.2 2.3c.5 0 .8-.3.8-.7s-.3-.7-.8-.7h-1v1.3l1 .1z&#x27;/%3e%3c/g%3e%3c/svg%3e" alt="Eclipse foundation Logo" class="jsx-3acb63b44722e9f1"/></a></div></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"slug":"3.9.8/vertx-circuit-breaker/groovy","title":"Vert.x Circuit Breaker","fallbackGitHubStars":null,"toc":"\u003cdiv id=\"toc\" class=\"toc\"\u003e\n\u003cdiv id=\"toctitle\"\u003eTable of Contents\u003c/div\u003e\n\u003cul class=\"sectlevel1\"\u003e\n\u003cli\u003e\u003ca href=\"#_using_the_vert_x_circuit_breaker\"\u003eUsing the vert.x circuit breaker\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_using_the_circuit_breaker\"\u003eUsing the circuit breaker\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_retries\"\u003eRetries\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_callbacks\"\u003eCallbacks\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_event_bus_notification\"\u003eEvent bus notification\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_the_half_open_state\"\u003eThe half-open state\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_reported_exceptions\"\u003eReported exceptions\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"#_pushing_circuit_breaker_metrics_to_the_hystrix_dashboard\"\u003ePushing circuit breaker metrics to the Hystrix Dashboard\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e","contents":"\u003ch1\u003eVert.x Circuit Breaker\u003c/h1\u003e\n\n\u003cdiv id=\"preamble\"\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eVert.x Circuit Breaker is an implementation of the Circuit Breaker \u003cem\u003epattern\u003c/em\u003e for Vert.x. It keeps track of the\nnumber of failures and \u003cem\u003eopens the circuit\u003c/em\u003e when a threshold is reached. Optionally, a fallback is executed.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eSupported failures are:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003efailures reported by your code in a \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/Future.html\"\u003eFuture\u003c/a\u003e\u003c/code\u003e\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eexception thrown by your code\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003euncompleted futures (timeout)\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOperations guarded by a circuit breaker are intended to be non-blocking and asynchronous in order to benefit from\nthe Vert.x execution model.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_using_the_vert_x_circuit_breaker\"\u003e\u003ca class=\"anchor\" href=\"#_using_the_vert_x_circuit_breaker\"\u003e\u003c/a\u003eUsing the vert.x circuit breaker\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use the Vert.x Circuit Breaker, add the following dependency to the \u003cem\u003edependencies\u003c/em\u003e section of your build\ndescriptor:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eMaven (in your \u003ccode\u003epom.xml\u003c/code\u003e):\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-xml\" data-lang=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003eio.vertx\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003egroupId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003evertx-circuit-breaker\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eartifactId\u003c/span\u003e\u0026gt;\u003c/span\u003e\n \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e3.9.8\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003eversion\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003edependency\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eGradle (in your \u003ccode\u003ebuild.gradle\u003c/code\u003e file):\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003ecompile \u003cspan class=\"hljs-string\"\u003e\u0026#x27;io.vertx:vertx-circuit-breaker:3.9.8\u0026#x27;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_using_the_circuit_breaker\"\u003e\u003ca class=\"anchor\" href=\"#_using_the_circuit_breaker\"\u003e\u003c/a\u003eUsing the circuit breaker\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eTo use the circuit breaker you need to:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"olist arabic\"\u003e\n\u003col class=\"arabic\"\u003e\n\u003cli\u003e\n\u003cp\u003eCreate a circuit breaker, with the configuration you want (timeout, number of failure before opening the circuit)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eExecute some code using the breaker\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003e\u003cstrong\u003eImportant\u003c/strong\u003e: Don\u0026#8217;t recreate a circuit breaker on every call. A circuit breaker is a staful entity. It is recommended\nto store the circuit breaker instance in a field.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eHere is an example:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e breaker = CircuitBreaker.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my-circuit-breaker\u0026quot;\u003c/span\u003e, vertx, [\n  \u003cspan class=\"hljs-symbol\"\u003emaxFailures:\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e,\n  \u003cspan class=\"hljs-symbol\"\u003etimeout:\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e2000\u003c/span\u003e,\n  \u003cspan class=\"hljs-symbol\"\u003efallbackOnFailure:\u003c/span\u003e\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n  \u003cspan class=\"hljs-symbol\"\u003eresetTimeout:\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e10000\u003c/span\u003e\n])\n\n\u003cspan class=\"hljs-comment\"\u003e// ---\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// Store the circuit breaker in a field and access it as follows\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// ---\u003c/span\u003e\n\nbreaker.execute({ future -\u0026gt;\n  \u003cspan class=\"hljs-comment\"\u003e// some code executing with the breaker\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// the code reports failures or success on the given future.\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// if this future is marked as failed, the breaker increased the\u003c/span\u003e\n  \u003cspan class=\"hljs-comment\"\u003e// number of failures\u003c/span\u003e\n}).setHandler({ ar -\u0026gt;\n  \u003cspan class=\"hljs-comment\"\u003e// Get the operation result.\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe executed block receives a \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/Future.html\"\u003eFuture\u003c/a\u003e\u003c/code\u003e object as parameter, to denote the\nsuccess or failure of the operation as well as the result. For example in the following example, the result is the\noutput of a REST endpoint invocation:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e breaker = CircuitBreaker.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my-circuit-breaker\u0026quot;\u003c/span\u003e, vertx, [\n  \u003cspan class=\"hljs-symbol\"\u003emaxFailures:\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e,\n  \u003cspan class=\"hljs-symbol\"\u003etimeout:\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e2000\u003c/span\u003e\n])\n\n\u003cspan class=\"hljs-comment\"\u003e// ---\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// Store the circuit breaker in a field and access it as follows\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// ---\u003c/span\u003e\n\nbreaker.execute({ future -\u0026gt;\n  vertx.createHttpClient().getNow(\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e, { response -\u0026gt;\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (response.statusCode() != \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e) {\n      future.fail(\u003cspan class=\"hljs-string\"\u003e\u0026quot;HTTP error\u0026quot;\u003c/span\u003e)\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      response.exceptionHandler(future.\u0026amp;fail).bodyHandler({ buffer -\u0026gt;\n        future.complete(buffer.toString())\n      })\n    }\n  })\n}).setHandler({ ar -\u0026gt;\n  \u003cspan class=\"hljs-comment\"\u003e// Do something with the result\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe result of the operation is provided using the:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003ereturned \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/Future.html\"\u003eFuture\u003c/a\u003e\u003c/code\u003e when calling \u003ccode\u003eexecute\u003c/code\u003e methods\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eprovided \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/core/Future.html\"\u003eFuture\u003c/a\u003e\u003c/code\u003e when calling the \u003ccode\u003eexecuteAndReport\u003c/code\u003e methods\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eOptionally, you can provide a fallback which is executed when the circuit is open:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e breaker = CircuitBreaker.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my-circuit-breaker\u0026quot;\u003c/span\u003e, vertx, [\n  \u003cspan class=\"hljs-symbol\"\u003emaxFailures:\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e,\n  \u003cspan class=\"hljs-symbol\"\u003etimeout:\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e2000\u003c/span\u003e\n])\n\n\u003cspan class=\"hljs-comment\"\u003e// ---\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// Store the circuit breaker in a field and access it as follows\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e// ---\u003c/span\u003e\n\nbreaker.executeWithFallback({ future -\u0026gt;\n  vertx.createHttpClient().getNow(\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e, { response -\u0026gt;\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (response.statusCode() != \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e) {\n      future.fail(\u003cspan class=\"hljs-string\"\u003e\u0026quot;HTTP error\u0026quot;\u003c/span\u003e)\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      response.exceptionHandler(future.\u0026amp;fail).bodyHandler({ buffer -\u0026gt;\n        future.complete(buffer.toString())\n      })\n    }\n  })\n}, { v -\u0026gt;\n  \u003cspan class=\"hljs-comment\"\u003e// Executed when the circuit is opened\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;Hello\u0026quot;\u003c/span\u003e\n}).setHandler({ ar -\u0026gt;\n  \u003cspan class=\"hljs-comment\"\u003e// Do something with the result\u003c/span\u003e\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe fallback is called whenever the circuit is open, or if the\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/circuitbreaker/CircuitBreakerOptions.html#isFallbackOnFailure--\"\u003eisFallbackOnFailure\u003c/a\u003e\u003c/code\u003e is enabled. When a fallback is\nset, the result is using the output of the fallback function. The fallback function takes as parameter a\n\u003ccode\u003e\u003ca href=\"../../apidocs/java/lang/Throwable.html\"\u003eThrowable\u003c/a\u003e\u003c/code\u003e object and returns an object of the expected type.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe fallback can also be set on the \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/circuitbreaker/CircuitBreaker.html\"\u003eCircuitBreaker\u003c/a\u003e\u003c/code\u003e object directly:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e breaker = CircuitBreaker.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my-circuit-breaker\u0026quot;\u003c/span\u003e, vertx, [\n  \u003cspan class=\"hljs-symbol\"\u003emaxFailures:\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e,\n  \u003cspan class=\"hljs-symbol\"\u003etimeout:\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e2000\u003c/span\u003e\n]).fallback({ v -\u0026gt;\n  \u003cspan class=\"hljs-comment\"\u003e// Executed when the circuit is opened.\u003c/span\u003e\n  \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026quot;hello\u0026quot;\u003c/span\u003e\n})\n\nbreaker.execute({ future -\u0026gt;\n  vertx.createHttpClient().getNow(\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e, { response -\u0026gt;\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (response.statusCode() != \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e) {\n      future.fail(\u003cspan class=\"hljs-string\"\u003e\u0026quot;HTTP error\u0026quot;\u003c/span\u003e)\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      response.exceptionHandler(future.\u0026amp;fail).bodyHandler({ buffer -\u0026gt;\n        future.complete(buffer.toString())\n      })\n    }\n  })\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_retries\"\u003e\u003ca class=\"anchor\" href=\"#_retries\"\u003e\u003c/a\u003eRetries\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also specify how often the circuit breaker should try your code before failing with\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/circuitbreaker/CircuitBreakerOptions.html#setMaxRetries-int-\"\u003esetMaxRetries\u003c/a\u003e\u003c/code\u003e.\nIf you set this to something higher than 0 your code gets executed several times before finally failing\nin the last execution. If the code succeeded in one of the retries your handler gets notified and any\nretries left are skipped. Retries are only supported when the circuit is closed.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNotice that if you set \u003ccode\u003emaxRetries\u003c/code\u003e to 2 for instance, your operation may be called 3 times: the initial attempt\nand 2 retries.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eBy default the timeout between retries is set to 0 which means that retries will be executed one after another without\nany delay. This, however, will result in increased load on the called service and may delay it\u0026#8217;s recovery.\nIn order to mitigate this problem it is recommended to execute retries with delays. \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/circuitbreaker/CircuitBreaker.html#retryPolicy-java.util.function.Function-\"\u003eretryPolicy\u003c/a\u003e\u003c/code\u003e\nmethod can be used to specify retry policy. Retry policy is a function which receives retry count as single argument\nand returns timeout in milliseconds before retry is executed and allows to implement a more complex policy, e.g.\nexponential backoff with jitter. Below is an example of retry timeout which grows linearly with each retry count:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e breaker = CircuitBreaker.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my-circuit-breaker\u0026quot;\u003c/span\u003e, vertx, [\n  \u003cspan class=\"hljs-symbol\"\u003emaxFailures:\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e,\n  \u003cspan class=\"hljs-symbol\"\u003emaxRetries:\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e,\n  \u003cspan class=\"hljs-symbol\"\u003etimeout:\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e2000\u003c/span\u003e\n]).openHandler({ v -\u0026gt;\n  println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Circuit opened\u0026quot;\u003c/span\u003e)\n}).closeHandler({ v -\u0026gt;\n  println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Circuit closed\u0026quot;\u003c/span\u003e)\n}).retryPolicy({ retryCount -\u0026gt;\n  retryCount * \u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003eL\n})\n\nbreaker.execute({ future -\u0026gt;\n  vertx.createHttpClient().getNow(\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e, { response -\u0026gt;\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (response.statusCode() != \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e) {\n      future.fail(\u003cspan class=\"hljs-string\"\u003e\u0026quot;HTTP error\u0026quot;\u003c/span\u003e)\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      \u003cspan class=\"hljs-comment\"\u003e// Do something with the response\u003c/span\u003e\n      future.complete()\n    }\n  })\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_callbacks\"\u003e\u003ca class=\"anchor\" href=\"#_callbacks\"\u003e\u003c/a\u003eCallbacks\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also configures callbacks invoked when the circuit is opened or closed:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003e\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e breaker = CircuitBreaker.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my-circuit-breaker\u0026quot;\u003c/span\u003e, vertx, [\n  \u003cspan class=\"hljs-symbol\"\u003emaxFailures:\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e,\n  \u003cspan class=\"hljs-symbol\"\u003etimeout:\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e2000\u003c/span\u003e\n]).openHandler({ v -\u0026gt;\n  println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Circuit opened\u0026quot;\u003c/span\u003e)\n}).closeHandler({ v -\u0026gt;\n  println(\u003cspan class=\"hljs-string\"\u003e\u0026quot;Circuit closed\u0026quot;\u003c/span\u003e)\n})\n\nbreaker.execute({ future -\u0026gt;\n  vertx.createHttpClient().getNow(\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;localhost\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e, { response -\u0026gt;\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (response.statusCode() != \u003cspan class=\"hljs-number\"\u003e200\u003c/span\u003e) {\n      future.fail(\u003cspan class=\"hljs-string\"\u003e\u0026quot;HTTP error\u0026quot;\u003c/span\u003e)\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e {\n      \u003cspan class=\"hljs-comment\"\u003e// Do something with the response\u003c/span\u003e\n      future.complete()\n    }\n  })\n})\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eYou can also be notified when the circuit breaker decides to attempt to reset (half-open state). You can register\nsuch a callback with \u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/circuitbreaker/CircuitBreaker.html#halfOpenHandler-io.vertx.core.Handler-\"\u003ehalfOpenHandler\u003c/a\u003e\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_event_bus_notification\"\u003e\u003ca class=\"anchor\" href=\"#_event_bus_notification\"\u003e\u003c/a\u003eEvent bus notification\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eEvery time the circuit state changes, an event is published on the event bus. The address on which the events are\nsent is configurable with\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/circuitbreaker/CircuitBreakerOptions.html#setNotificationAddress-java.lang.String-\"\u003esetNotificationAddress\u003c/a\u003e\u003c/code\u003e. If \u003ccode\u003enull\u003c/code\u003e is\npassed to this method, the notifications are disabled. By default, the used address is \u003ccode\u003evertx.circuit-breaker\u003c/code\u003e.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eEach event contains a Json Object with:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003estate\u003c/code\u003e : the new circuit breaker state (\u003ccode\u003eOPEN\u003c/code\u003e, \u003ccode\u003eCLOSED\u003c/code\u003e, \u003ccode\u003eHALF_OPEN\u003c/code\u003e)\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ename\u003c/code\u003e : the name of the circuit breaker\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003efailures\u003c/code\u003e : the number of failures\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003enode\u003c/code\u003e : the identifier of the node (\u003ccode\u003elocal\u003c/code\u003e if Vert.x is not running in cluster mode)\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_the_half_open_state\"\u003e\u003ca class=\"anchor\" href=\"#_the_half_open_state\"\u003e\u003c/a\u003eThe half-open state\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eWhen the circuit is \"open\", calls to the circuit breaker fail immediately, without any attempt to execute the real\noperation. After a suitable amount of time (configured from\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/circuitbreaker/CircuitBreakerOptions.html#setResetTimeout-long-\"\u003esetResetTimeout\u003c/a\u003e\u003c/code\u003e, the circuit breaker decides that the\noperation has a chance of succeeding, so it goes into the \u003ccode\u003ehalf-open\u003c/code\u003e state. In this state, the next call to the\ncircuit breaker is allowed to execute the dangerous operation. Should the call succeed, the circuit breaker resets\nand returns to the \u003ccode\u003eclosed\u003c/code\u003e state, ready for more routine operation. If this trial call fails, however, the circuit\nbreaker returns to the \u003ccode\u003eopen\u003c/code\u003e state until another timeout elapses.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_reported_exceptions\"\u003e\u003ca class=\"anchor\" href=\"#_reported_exceptions\"\u003e\u003c/a\u003eReported exceptions\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eThe fallback receives a:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"ulist\"\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/circuitbreaker/OpenCircuitException.html\"\u003eOpenCircuitException\u003c/a\u003e\u003c/code\u003e when the circuit breaker is opened\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/circuitbreaker/TimeoutException.html\"\u003eTimeoutException\u003c/a\u003e\u003c/code\u003e when the operation timed out\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"sect1\"\u003e\n\u003ch2 id=\"_pushing_circuit_breaker_metrics_to_the_hystrix_dashboard\"\u003e\u003ca class=\"anchor\" href=\"#_pushing_circuit_breaker_metrics_to_the_hystrix_dashboard\"\u003e\u003c/a\u003ePushing circuit breaker metrics to the Hystrix Dashboard\u003c/h2\u003e\n\u003cdiv class=\"sectionbody\"\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNetflix Hystrix comes with a dashboard to present the current state of the circuit breakers. The Vert.x circuit\nbreakers can publish their metrics in order to be consumed by this Hystrix Dashboard. The Hystrix dashboard requires\na SSE stream sending the metrics. This stream is provided by the\n\u003ccode\u003e\u003ca href=\"../../apidocs/io/vertx/circuitbreaker/HystrixMetricHandler.html\"\u003eHystrixMetricHandler\u003c/a\u003e\u003c/code\u003e Vert.x Web Handler:\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"listingblock\"\u003e\n\u003cdiv class=\"content\"\u003e\n\u003cpre class=\"highlight\"\u003e\u003ccode class=\"language-groovy\" data-lang=\"groovy\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Create the circuit breaker as usual.\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e breaker = CircuitBreaker.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my-circuit-breaker\u0026quot;\u003c/span\u003e, vertx)\n\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e breaker2 = CircuitBreaker.create(\u003cspan class=\"hljs-string\"\u003e\u0026quot;my-second-circuit-breaker\u0026quot;\u003c/span\u003e, vertx)\n\n\u003cspan class=\"hljs-comment\"\u003e// Create a Vert.x Web router\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003edef\u003c/span\u003e router = Router.router(vertx)\n\u003cspan class=\"hljs-comment\"\u003e// Register the metric handler\u003c/span\u003e\nrouter.get(\u003cspan class=\"hljs-string\"\u003e\u0026quot;/hystrix-metrics\u0026quot;\u003c/span\u003e).handler(HystrixMetricHandler.create(vertx))\n\n\u003cspan class=\"hljs-comment\"\u003e// Create the HTTP server using the router to dispatch the requests\u003c/span\u003e\nvertx.createHttpServer().requestHandler(router).listen(\u003cspan class=\"hljs-number\"\u003e8080\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eIn the Hystrix Dashboard, configure the stream url like: \u003ccode\u003e\u003ca href=\"http://localhost:8080/metrics\" class=\"bare\"\u003ehttp://localhost:8080/metrics\u003c/a\u003e\u003c/code\u003e. The dashboard now consumes\nthe metrics from the Vert.x circuit breakers.\u003c/p\u003e\n\u003c/div\u003e\n\u003cdiv class=\"paragraph\"\u003e\n\u003cp\u003eNotice that the metrics are collected by the Vert.x Web handler using the event bus notifications. If you don\u0026#8217;t use\nthe default notification address, you need to pass it when creating the metrics handler.\u003c/p\u003e\n\u003c/div\u003e\n\u003c/div\u003e\n\u003c/div\u003e","version":"3.9.8"},"__N_SSG":true},"page":"/docs/[[...slug]]","query":{"slug":["3.9.8","vertx-circuit-breaker","groovy"]},"buildId":"TfCrH4GEYTYgoXJBLUTks","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>