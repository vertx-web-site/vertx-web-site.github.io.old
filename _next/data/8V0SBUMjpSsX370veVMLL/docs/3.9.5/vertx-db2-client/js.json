{"pageProps":{"slug":"3.9.5/vertx-db2-client/js","title":"Reactive DB2 Client","fallbackGitHubStars":null,"toc":"<div id=\"toc\" class=\"toc\">\n<div id=\"toctitle\">Table of Contents</div>\n<ul class=\"sectlevel1\">\n<li><a href=\"#_usage\">Usage</a></li>\n<li><a href=\"#_getting_started\">Getting started</a></li>\n<li><a href=\"#_connecting_to_db2\">Connecting to DB2</a></li>\n<li><a href=\"#_configuration\">Configuration</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_data_object\">data object</a></li>\n<li><a href=\"#_connection_uri\">connection uri</a></li>\n</ul>\n</li>\n<li><a href=\"#_running_queries\">Running queries</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_prepared_queries\">Prepared queries</a></li>\n<li><a href=\"#_batches\">Batches</a></li>\n</ul>\n</li>\n<li><a href=\"#_using_connections\">Using connections</a></li>\n<li><a href=\"#_using_transactions\">Using transactions</a>\n<ul class=\"sectlevel2\">\n<li><a href=\"#_transactions_with_connections\">Transactions with connections</a></li>\n<li><a href=\"#_simplified_transaction_api\">Simplified transaction API</a></li>\n</ul>\n</li>\n<li><a href=\"#_cursors_and_streaming\">Cursors and streaming</a></li>\n<li><a href=\"#_db2_type_mapping\">DB2 type mapping</a></li>\n<li><a href=\"#_using_java_enum_types\">Using Java enum types</a></li>\n<li><a href=\"#_collector_queries\">Collector queries</a></li>\n<li><a href=\"#_using_ssltls\">Using SSL/TLS</a></li>\n<li><a href=\"#_using_a_proxy\">Using a proxy</a></li>\n</ul>\n</div>","contents":"<h1>Reactive DB2 Client</h1>\n\n<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>The Reactive DB2 Client is a client for DB2 with a straightforward API focusing on\nscalability and low overhead.</p>\n</div>\n<div class=\"paragraph\">\n<p>The client is reactive and non blocking, allowing to handle many database connections with a single thread.</p>\n</div>\n<div class=\"paragraph\">\n<p><strong>Features</strong></p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Support for DB2 on Linux, Unix, and Windows</p>\n</li>\n<li>\n<p>Limited support for DB2 on z/OS</p>\n</li>\n<li>\n<p>Event driven</p>\n</li>\n<li>\n<p>Lightweight</p>\n</li>\n<li>\n<p>Built-in connection pooling</p>\n</li>\n<li>\n<p>Prepared queries caching</p>\n</li>\n<li>\n<p>Batch and cursor</p>\n</li>\n<li>\n<p>Row streaming</p>\n</li>\n<li>\n<p>RxJava 1 and RxJava 2</p>\n</li>\n<li>\n<p>Direct memory to object without unnecessary copies</p>\n</li>\n<li>\n<p>Java 8 Date and Time</p>\n</li>\n<li>\n<p>SSL/TLS</p>\n</li>\n<li>\n<p>HTTP/1.x CONNECT, SOCKS4a or SOCKS5 proxy support</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p><strong>Current limitations</strong></p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>No stored procedures support</p>\n</li>\n<li>\n<p>Some column types (e.g. BLOB and CLOB) are not supported</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_usage\"><a class=\"anchor\" href=\"#_usage\"></a>Usage</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>To use the Reactive DB2 Client add the following dependency to the <em>dependencies</em> section of your build descriptor:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Maven (in your <code>pom.xml</code>):</p>\n</li>\n</ul>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-xml\" data-lang=\"xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.vertx<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>vertx-lang-js<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>3.9.5<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span></code></pre>\n</div>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Gradle (in your <code>build.gradle</code> file):</p>\n</li>\n</ul>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-groovy\" data-lang=\"groovy\">dependencies {\n compile <span class=\"hljs-string\">&#x27;io.vertx:vertx-lang-js:3.9.5&#x27;</span>\n}</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_getting_started\"><a class=\"anchor\" href=\"#_getting_started\"></a>Getting started</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Here is the simplest way to connect, query and disconnect</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">DB2Pool</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-db2-client-js/db2_pool&quot;</span>);\n\n<span class=\"hljs-comment\">// Connect options</span>\n<span class=\"hljs-keyword\">var</span> connectOptions = {\n  <span class=\"hljs-string\">&quot;port&quot;</span> : <span class=\"hljs-number\">50000</span>,\n  <span class=\"hljs-string\">&quot;host&quot;</span> : <span class=\"hljs-string\">&quot;the-host&quot;</span>,\n  <span class=\"hljs-string\">&quot;database&quot;</span> : <span class=\"hljs-string\">&quot;the-db&quot;</span>,\n  <span class=\"hljs-string\">&quot;user&quot;</span> : <span class=\"hljs-string\">&quot;user&quot;</span>,\n  <span class=\"hljs-string\">&quot;password&quot;</span> : <span class=\"hljs-string\">&quot;secret&quot;</span>\n};\n\n<span class=\"hljs-comment\">// Pool options</span>\n<span class=\"hljs-keyword\">var</span> poolOptions = {\n  <span class=\"hljs-string\">&quot;maxSize&quot;</span> : <span class=\"hljs-number\">5</span>\n};\n\n<span class=\"hljs-comment\">// Create the client pool</span>\n<span class=\"hljs-keyword\">var</span> client = <span class=\"hljs-title class_\">DB2Pool</span>.<span class=\"hljs-title function_\">pool</span>(connectOptions, poolOptions);\n\n<span class=\"hljs-comment\">// A simple query</span>\nclient.<span class=\"hljs-title function_\">query</span>(<span class=\"hljs-string\">&quot;SELECT * FROM users WHERE id=&#x27;julien&#x27;&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar, ar_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (ar_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">var</span> result = ar;\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Got &quot;</span> + result.<span class=\"hljs-title function_\">size</span>() + <span class=\"hljs-string\">&quot; rows &quot;</span>);\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Failure: &quot;</span> + ar_err.<span class=\"hljs-title function_\">getMessage</span>());\n  }\n\n  <span class=\"hljs-comment\">// Now close the pool</span>\n  client.<span class=\"hljs-title function_\">close</span>();\n});</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_connecting_to_db2\"><a class=\"anchor\" href=\"#_connecting_to_db2\"></a>Connecting to DB2</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Most of the time you will use a pool to connect to DB2:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">DB2Pool</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-db2-client-js/db2_pool&quot;</span>);\n\n<span class=\"hljs-comment\">// Connect options</span>\n<span class=\"hljs-keyword\">var</span> connectOptions = {\n  <span class=\"hljs-string\">&quot;port&quot;</span> : <span class=\"hljs-number\">50000</span>,\n  <span class=\"hljs-string\">&quot;host&quot;</span> : <span class=\"hljs-string\">&quot;the-host&quot;</span>,\n  <span class=\"hljs-string\">&quot;database&quot;</span> : <span class=\"hljs-string\">&quot;the-db&quot;</span>,\n  <span class=\"hljs-string\">&quot;user&quot;</span> : <span class=\"hljs-string\">&quot;user&quot;</span>,\n  <span class=\"hljs-string\">&quot;password&quot;</span> : <span class=\"hljs-string\">&quot;secret&quot;</span>\n};\n\n<span class=\"hljs-comment\">// Pool options</span>\n<span class=\"hljs-keyword\">var</span> poolOptions = {\n  <span class=\"hljs-string\">&quot;maxSize&quot;</span> : <span class=\"hljs-number\">5</span>\n};\n\n<span class=\"hljs-comment\">// Create the pooled client</span>\n<span class=\"hljs-keyword\">var</span> client = <span class=\"hljs-title class_\">DB2Pool</span>.<span class=\"hljs-title function_\">pool</span>(connectOptions, poolOptions);</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>The pooled client uses a connection pool and any operation will borrow a connection from the pool\nto execute the operation and release it to the pool.</p>\n</div>\n<div class=\"paragraph\">\n<p>If you are running with Vert.x you can pass it your Vertx instance:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">DB2Pool</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-db2-client-js/db2_pool&quot;</span>);\n\n<span class=\"hljs-comment\">// Connect options</span>\n<span class=\"hljs-keyword\">var</span> connectOptions = {\n  <span class=\"hljs-string\">&quot;port&quot;</span> : <span class=\"hljs-number\">50000</span>,\n  <span class=\"hljs-string\">&quot;host&quot;</span> : <span class=\"hljs-string\">&quot;the-host&quot;</span>,\n  <span class=\"hljs-string\">&quot;database&quot;</span> : <span class=\"hljs-string\">&quot;the-db&quot;</span>,\n  <span class=\"hljs-string\">&quot;user&quot;</span> : <span class=\"hljs-string\">&quot;user&quot;</span>,\n  <span class=\"hljs-string\">&quot;password&quot;</span> : <span class=\"hljs-string\">&quot;secret&quot;</span>\n};\n\n<span class=\"hljs-comment\">// Pool options</span>\n<span class=\"hljs-keyword\">var</span> poolOptions = {\n  <span class=\"hljs-string\">&quot;maxSize&quot;</span> : <span class=\"hljs-number\">5</span>\n};\n<span class=\"hljs-comment\">// Create the pooled client</span>\n<span class=\"hljs-keyword\">var</span> client = <span class=\"hljs-title class_\">DB2Pool</span>.<span class=\"hljs-title function_\">pool</span>(vertx, connectOptions, poolOptions);</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>You need to release the pool when you don&#8217;t need it anymore:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-comment\">// Close the pool and all the associated resources</span>\npool.<span class=\"hljs-title function_\">close</span>();</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>When you need to execute several operations on the same connection, you need to use a client\n<code><a href=\"../../jsdoc/module-vertx-db2-client-js_db2_connection-DB2Connection.html\">connection</a></code>.</p>\n</div>\n<div class=\"paragraph\">\n<p>You can easily get one from the pool:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">DB2Pool</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-db2-client-js/db2_pool&quot;</span>);\n\n<span class=\"hljs-comment\">// Connect options</span>\n<span class=\"hljs-keyword\">var</span> connectOptions = {\n  <span class=\"hljs-string\">&quot;port&quot;</span> : <span class=\"hljs-number\">50000</span>,\n  <span class=\"hljs-string\">&quot;host&quot;</span> : <span class=\"hljs-string\">&quot;the-host&quot;</span>,\n  <span class=\"hljs-string\">&quot;database&quot;</span> : <span class=\"hljs-string\">&quot;the-db&quot;</span>,\n  <span class=\"hljs-string\">&quot;user&quot;</span> : <span class=\"hljs-string\">&quot;user&quot;</span>,\n  <span class=\"hljs-string\">&quot;password&quot;</span> : <span class=\"hljs-string\">&quot;secret&quot;</span>\n};\n\n<span class=\"hljs-comment\">// Pool options</span>\n<span class=\"hljs-keyword\">var</span> poolOptions = {\n  <span class=\"hljs-string\">&quot;maxSize&quot;</span> : <span class=\"hljs-number\">5</span>\n};\n\n<span class=\"hljs-comment\">// Create the pooled client</span>\n<span class=\"hljs-keyword\">var</span> client = <span class=\"hljs-title class_\">DB2Pool</span>.<span class=\"hljs-title function_\">pool</span>(vertx, connectOptions, poolOptions);\n\n<span class=\"hljs-comment\">// Get a connection from the pool</span>\nclient.<span class=\"hljs-title function_\">getConnection</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar1, ar1_err</span>) {\n\n  <span class=\"hljs-keyword\">if</span> (ar1_err == <span class=\"hljs-literal\">null</span>) {\n\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Connected&quot;</span>);\n\n    <span class=\"hljs-comment\">// Obtain our connection</span>\n    <span class=\"hljs-keyword\">var</span> conn = ar1;\n\n    <span class=\"hljs-comment\">// All operations execute on the same connection</span>\n    conn.<span class=\"hljs-title function_\">query</span>(<span class=\"hljs-string\">&quot;SELECT * FROM users WHERE id=&#x27;julien&#x27;&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar2, ar2_err</span>) {\n      <span class=\"hljs-keyword\">if</span> (ar2_err == <span class=\"hljs-literal\">null</span>) {\n        conn.<span class=\"hljs-title function_\">query</span>(<span class=\"hljs-string\">&quot;SELECT * FROM users WHERE id=&#x27;emad&#x27;&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar3, ar3_err</span>) {\n          <span class=\"hljs-comment\">// Release the connection to the pool</span>\n          conn.<span class=\"hljs-title function_\">close</span>();\n        });\n      } <span class=\"hljs-keyword\">else</span> {\n        <span class=\"hljs-comment\">// Release the connection to the pool</span>\n        conn.<span class=\"hljs-title function_\">close</span>();\n      }\n    });\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Could not connect: &quot;</span> + ar1_err.<span class=\"hljs-title function_\">getMessage</span>());\n  }\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>Once you are done with the connection you must close it to release it to the pool, so it can be reused.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_configuration\"><a class=\"anchor\" href=\"#_configuration\"></a>Configuration</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>There are several alternatives for you to configure the client.</p>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_data_object\"><a class=\"anchor\" href=\"#_data_object\"></a>data object</h3>\n<div class=\"paragraph\">\n<p>A simple way to configure the client is to specify a <code>DB2ConnectOptions</code> data object.</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">DB2Pool</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-db2-client-js/db2_pool&quot;</span>);\n\n<span class=\"hljs-comment\">// Data object</span>\n<span class=\"hljs-keyword\">var</span> connectOptions = {\n  <span class=\"hljs-string\">&quot;port&quot;</span> : <span class=\"hljs-number\">50000</span>,\n  <span class=\"hljs-string\">&quot;host&quot;</span> : <span class=\"hljs-string\">&quot;the-host&quot;</span>,\n  <span class=\"hljs-string\">&quot;database&quot;</span> : <span class=\"hljs-string\">&quot;the-db&quot;</span>,\n  <span class=\"hljs-string\">&quot;user&quot;</span> : <span class=\"hljs-string\">&quot;user&quot;</span>,\n  <span class=\"hljs-string\">&quot;password&quot;</span> : <span class=\"hljs-string\">&quot;secret&quot;</span>\n};\n\n<span class=\"hljs-comment\">// Pool Options</span>\n<span class=\"hljs-keyword\">var</span> poolOptions = {\n  <span class=\"hljs-string\">&quot;maxSize&quot;</span> : <span class=\"hljs-number\">5</span>\n};\n\n<span class=\"hljs-comment\">// Create the pool from the data object</span>\n<span class=\"hljs-keyword\">var</span> pool = <span class=\"hljs-title class_\">DB2Pool</span>.<span class=\"hljs-title function_\">pool</span>(vertx, connectOptions, poolOptions);\n\npool.<span class=\"hljs-title function_\">getConnection</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar, ar_err</span>) {\n  <span class=\"hljs-comment\">// Handling your connection</span>\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>You can also configure the generic properties with the <code>setProperties</code> or <code>addProperty</code> methods. Note <code>setProperties</code> will override the default client properties.</p>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_connection_uri\"><a class=\"anchor\" href=\"#_connection_uri\"></a>connection uri</h3>\n<div class=\"paragraph\">\n<p>Apart from configuring with a <code>DB2ConnectOptions</code> data object, We also provide you an alternative way to connect when you want to configure with a connection URI:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">DB2Pool</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-db2-client-js/db2_pool&quot;</span>);\n<span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">DB2Connection</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-db2-client-js/db2_connection&quot;</span>);\n\n<span class=\"hljs-comment\">// Connection URI</span>\n<span class=\"hljs-keyword\">var</span> connectionUri = <span class=\"hljs-string\">&quot;db2://dbuser:secretpassword@database.server.com:50000/mydb&quot;</span>;\n\n<span class=\"hljs-comment\">// Create the pool from the connection URI</span>\n<span class=\"hljs-keyword\">var</span> pool = <span class=\"hljs-title class_\">DB2Pool</span>.<span class=\"hljs-title function_\">pool</span>(connectionUri);\n\n<span class=\"hljs-comment\">// Create the connection from the connection URI</span>\n<span class=\"hljs-title class_\">DB2Connection</span>.<span class=\"hljs-title function_\">connect</span>(vertx, connectionUri, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">res, res_err</span>) {\n  <span class=\"hljs-comment\">// Handling your connection</span>\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>The URI format for a connection string is:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre>db2://&lt;USERNAME&gt;:&lt;PASSWORD&gt;@&lt;HOSTNAME&gt;:&lt;PORT&gt;/&lt;DBNAME&gt;</pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>Currently the client supports the following parameter key words in connection uri</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>host</p>\n</li>\n<li>\n<p>port</p>\n</li>\n<li>\n<p>user</p>\n</li>\n<li>\n<p>password</p>\n</li>\n<li>\n<p>dbname</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Note: configuring properties in connection URI will override the default properties.</p>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_running_queries\"><a class=\"anchor\" href=\"#_running_queries\"></a>Running queries</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>When you don&#8217;t need a transaction or run single queries, you can run queries directly on the pool; the pool\nwill use one of its connection to run the query and return the result to you.</p>\n</div>\n<div class=\"paragraph\">\n<p>Here is how to run simple queries:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\">client.<span class=\"hljs-title function_\">query</span>(<span class=\"hljs-string\">&quot;SELECT * FROM users WHERE id=&#x27;andy&#x27;&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar, ar_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (ar_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">var</span> result = ar;\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Got &quot;</span> + result.<span class=\"hljs-title function_\">size</span>() + <span class=\"hljs-string\">&quot; rows &quot;</span>);\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Failure: &quot;</span> + ar_err.<span class=\"hljs-title function_\">getMessage</span>());\n  }\n});</code></pre>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_prepared_queries\"><a class=\"anchor\" href=\"#_prepared_queries\"></a>Prepared queries</h3>\n<div class=\"paragraph\">\n<p>You can do the same with prepared queries.</p>\n</div>\n<div class=\"paragraph\">\n<p>The SQL string can refer to parameters by position, using the database syntax `?`â€‹</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">Tuple</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-sql-client-js/tuple&quot;</span>);\nclient.<span class=\"hljs-title function_\">preparedQuery</span>(<span class=\"hljs-string\">&quot;SELECT * FROM users WHERE id=$1&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-title class_\">Tuple</span>.<span class=\"hljs-title function_\">of</span>(<span class=\"hljs-string\">&quot;andy&quot;</span>), <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar, ar_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (ar_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">var</span> rows = ar;\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Got &quot;</span> + rows.<span class=\"hljs-title function_\">size</span>() + <span class=\"hljs-string\">&quot; rows &quot;</span>);\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Failure: &quot;</span> + ar_err.<span class=\"hljs-title function_\">getMessage</span>());\n  }\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>Query methods provides an asynchronous <code><a href=\"../../jsdoc/module-vertx-sql-client-js_row_set-RowSet.html\">RowSet</a></code> instance that works for <em>SELECT</em> queries</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\">client.<span class=\"hljs-title function_\">preparedQuery</span>(<span class=\"hljs-string\">&quot;SELECT first_name, last_name FROM users&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar, ar_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (ar_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">var</span> rows = ar;\n    <span class=\"hljs-title class_\">Array</span>.<span class=\"hljs-property\"><span class=\"hljs-keyword\">prototype</span></span>.<span class=\"hljs-property\">forEach</span>.<span class=\"hljs-title function_\">call</span>(rows, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">row</span>) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;User &quot;</span> + row.<span class=\"hljs-title function_\">getString</span>(<span class=\"hljs-number\">0</span>) + <span class=\"hljs-string\">&quot; &quot;</span> + row.<span class=\"hljs-title function_\">getString</span>(<span class=\"hljs-number\">1</span>));\n    });\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Failure: &quot;</span> + ar_err.<span class=\"hljs-title function_\">getMessage</span>());\n  }\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>or <em>UPDATE</em>/<em>INSERT</em> queries:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">Tuple</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-sql-client-js/tuple&quot;</span>);\nclient.<span class=\"hljs-title function_\">preparedQuery</span>(<span class=\"hljs-string\">&quot;INSERT INTO users (first_name, last_name) VALUES ($1, $2)&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-title class_\">Tuple</span>.<span class=\"hljs-title function_\">of</span>(<span class=\"hljs-string\">&quot;Andy&quot;</span>, <span class=\"hljs-string\">&quot;Guibert&quot;</span>), <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar, ar_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (ar_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">var</span> rows = ar;\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(rows.<span class=\"hljs-title function_\">rowCount</span>());\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Failure: &quot;</span> + ar_err.<span class=\"hljs-title function_\">getMessage</span>());\n  }\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>The <code><a href=\"../../jsdoc/module-vertx-sql-client-js_row-Row.html\">Row</a></code> gives you access to your data by index</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;User &quot;</span> + row.<span class=\"hljs-title function_\">getString</span>(<span class=\"hljs-number\">0</span>) + <span class=\"hljs-string\">&quot; &quot;</span> + row.<span class=\"hljs-title function_\">getString</span>(<span class=\"hljs-number\">1</span>));</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>or by name</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;User &quot;</span> + row.<span class=\"hljs-title function_\">getString</span>(<span class=\"hljs-string\">&quot;first_name&quot;</span>) + <span class=\"hljs-string\">&quot; &quot;</span> + row.<span class=\"hljs-title function_\">getString</span>(<span class=\"hljs-string\">&quot;last_name&quot;</span>));</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>The client will not do any magic here and the column name is identified with the name in the table regardless of how your SQL text is.</p>\n</div>\n<div class=\"paragraph\">\n<p>You can access a wide variety of of types</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> firstName = row.<span class=\"hljs-title function_\">getString</span>(<span class=\"hljs-string\">&quot;first_name&quot;</span>);\n<span class=\"hljs-keyword\">var</span> male = row.<span class=\"hljs-title function_\">getBoolean</span>(<span class=\"hljs-string\">&quot;male&quot;</span>);\n<span class=\"hljs-keyword\">var</span> age = row.<span class=\"hljs-title function_\">getInteger</span>(<span class=\"hljs-string\">&quot;age&quot;</span>);\n\n<span class=\"hljs-comment\">// ...</span></code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>You can use cached prepared statements to execute one-shot prepared queries:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">Tuple</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-sql-client-js/tuple&quot;</span>);\n\n<span class=\"hljs-comment\">// Enable prepare statements caching</span>\nconnectOptions.<span class=\"hljs-property\">cachePreparedStatements</span> = <span class=\"hljs-literal\">true</span>;\nclient.<span class=\"hljs-title function_\">preparedQuery</span>(<span class=\"hljs-string\">&quot;SELECT * FROM users WHERE id = ?&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-title class_\">Tuple</span>.<span class=\"hljs-title function_\">of</span>(<span class=\"hljs-string\">&quot;julien&quot;</span>), <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar, ar_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (ar_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">var</span> rows = ar;\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Got &quot;</span> + rows.<span class=\"hljs-title function_\">size</span>() + <span class=\"hljs-string\">&quot; rows &quot;</span>);\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Failure: &quot;</span> + ar_err.<span class=\"hljs-title function_\">getMessage</span>());\n  }\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>You can create a <code>PreparedStatement</code> and manage the lifecycle by yourself.</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">Tuple</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-sql-client-js/tuple&quot;</span>);\nsqlConnection.<span class=\"hljs-title function_\">prepare</span>(<span class=\"hljs-string\">&quot;SELECT * FROM users WHERE id= ?&quot;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar, ar_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (ar_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">var</span> preparedStatement = ar;\n    preparedStatement.<span class=\"hljs-title function_\">query</span>().<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-title class_\">Tuple</span>.<span class=\"hljs-title function_\">of</span>(<span class=\"hljs-string\">&quot;julien&quot;</span>), <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar2, ar2_err</span>) {\n      <span class=\"hljs-keyword\">if</span> (ar2_err == <span class=\"hljs-literal\">null</span>) {\n        <span class=\"hljs-keyword\">var</span> rows = ar2;\n        <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Got &quot;</span> + rows.<span class=\"hljs-title function_\">size</span>() + <span class=\"hljs-string\">&quot; rows &quot;</span>);\n        preparedStatement.<span class=\"hljs-title function_\">close</span>();\n      } <span class=\"hljs-keyword\">else</span> {\n        <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Failure: &quot;</span> + ar2_err.<span class=\"hljs-title function_\">getMessage</span>());\n      }\n    });\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Failure: &quot;</span> + ar_err.<span class=\"hljs-title function_\">getMessage</span>());\n  }\n});</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_batches\"><a class=\"anchor\" href=\"#_batches\"></a>Batches</h3>\n<div class=\"paragraph\">\n<p>You can execute prepared batch</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">Tuple</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-sql-client-js/tuple&quot;</span>);\n\n<span class=\"hljs-comment\">// Add commands to the batch</span>\n<span class=\"hljs-keyword\">var</span> batch = [];\nbatch.<span class=\"hljs-title function_\">push</span>(<span class=\"hljs-title class_\">Tuple</span>.<span class=\"hljs-title function_\">of</span>(<span class=\"hljs-string\">&quot;julien&quot;</span>, <span class=\"hljs-string\">&quot;Julient Viet&quot;</span>));\nbatch.<span class=\"hljs-title function_\">push</span>(<span class=\"hljs-title class_\">Tuple</span>.<span class=\"hljs-title function_\">of</span>(<span class=\"hljs-string\">&quot;emad&quot;</span>, <span class=\"hljs-string\">&quot;Emad Alblueshi&quot;</span>));\nbatch.<span class=\"hljs-title function_\">push</span>(<span class=\"hljs-title class_\">Tuple</span>.<span class=\"hljs-title function_\">of</span>(<span class=\"hljs-string\">&quot;andy&quot;</span>, <span class=\"hljs-string\">&quot;Andy Guibert&quot;</span>));\n\n<span class=\"hljs-comment\">// Execute the prepared batch</span>\nclient.<span class=\"hljs-title function_\">preparedQuery</span>(<span class=\"hljs-string\">&quot;INSERT INTO USERS (id, name) VALUES ($1, $2)&quot;</span>).<span class=\"hljs-title function_\">executeBatch</span>(batch, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">res, res_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (res_err == <span class=\"hljs-literal\">null</span>) {\n\n    <span class=\"hljs-comment\">// Process rows</span>\n    <span class=\"hljs-keyword\">var</span> rows = res;\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Batch failed &quot;</span> + res_err);\n  }\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>You can fetch generated keys by wrapping your query in <code>SELECT &lt;COLUMNS&gt; FROM FINAL TABLE ( &lt;SQL&gt; )</code>, for example:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">Tuple</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-sql-client-js/tuple&quot;</span>);\nclient.<span class=\"hljs-title function_\">preparedQuery</span>(<span class=\"hljs-string\">&quot;SELECT color_id FROM FINAL TABLE ( INSERT INTO color (color_name) VALUES (?), (?), (?) )&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-title class_\">Tuple</span>.<span class=\"hljs-title function_\">of</span>(<span class=\"hljs-string\">&quot;white&quot;</span>, <span class=\"hljs-string\">&quot;red&quot;</span>, <span class=\"hljs-string\">&quot;blue&quot;</span>), <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar, ar_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (ar_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">var</span> rows = ar;\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Inserted &quot;</span> + rows.<span class=\"hljs-title function_\">rowCount</span>() + <span class=\"hljs-string\">&quot; new rows.&quot;</span>);\n    <span class=\"hljs-title class_\">Array</span>.<span class=\"hljs-property\"><span class=\"hljs-keyword\">prototype</span></span>.<span class=\"hljs-property\">forEach</span>.<span class=\"hljs-title function_\">call</span>(rows, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">row</span>) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;generated key: &quot;</span> + row.<span class=\"hljs-title function_\">getInteger</span>(<span class=\"hljs-string\">&quot;color_id&quot;</span>));\n    });\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Failure: &quot;</span> + ar_err.<span class=\"hljs-title function_\">getMessage</span>());\n  }\n});</code></pre>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_using_connections\"><a class=\"anchor\" href=\"#_using_connections\"></a>Using connections</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>When you need to execute sequential queries (without a transaction), you can create a new connection\nor borrow one from the pool:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-title class_\">Code</span> not translatable</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>Prepared queries can be created:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">Tuple</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-sql-client-js/tuple&quot;</span>);\nconnection.<span class=\"hljs-title function_\">prepare</span>(<span class=\"hljs-string\">&quot;SELECT * FROM users WHERE first_name LIKE $1&quot;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar1, ar1_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (ar1_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">var</span> pq = ar1;\n    pq.<span class=\"hljs-title function_\">query</span>().<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-title class_\">Tuple</span>.<span class=\"hljs-title function_\">of</span>(<span class=\"hljs-string\">&quot;andy&quot;</span>), <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar2, ar2_err</span>) {\n      <span class=\"hljs-keyword\">if</span> (ar2_err == <span class=\"hljs-literal\">null</span>) {\n        <span class=\"hljs-comment\">// All rows</span>\n        <span class=\"hljs-keyword\">var</span> rows = ar2;\n      }\n    });\n  }\n});</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_using_transactions\"><a class=\"anchor\" href=\"#_using_transactions\"></a>Using transactions</h2>\n<div class=\"sectionbody\">\n<div class=\"sect2\">\n<h3 id=\"_transactions_with_connections\"><a class=\"anchor\" href=\"#_transactions_with_connections\"></a>Transactions with connections</h3>\n<div class=\"paragraph\">\n<p>You can execute transaction using SQL <code>BEGIN</code>/<code>COMMIT</code>/<code>ROLLBACK</code>, if you do so you must use\na <code><a href=\"../../jsdoc/module-vertx-sql-client-js_sql_connection-SqlConnection.html\">SqlConnection</a></code> and manage it yourself.</p>\n</div>\n<div class=\"paragraph\">\n<p>Or you can use the transaction API of <code><a href=\"../../jsdoc/module-vertx-sql-client-js_sql_connection-SqlConnection.html\">SqlConnection</a></code>:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\">pool.<span class=\"hljs-title function_\">getConnection</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">res, res_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (res_err == <span class=\"hljs-literal\">null</span>) {\n\n    <span class=\"hljs-comment\">// Transaction must use a connection</span>\n    <span class=\"hljs-keyword\">var</span> conn = res;\n\n    <span class=\"hljs-comment\">// Begin the transaction</span>\n    <span class=\"hljs-keyword\">var</span> tx = conn.<span class=\"hljs-title function_\">begin</span>();\n\n    <span class=\"hljs-comment\">// Various statements</span>\n    conn.<span class=\"hljs-title function_\">query</span>(<span class=\"hljs-string\">&quot;INSERT INTO Users (first_name,last_name) VALUES (&#x27;Julien&#x27;,&#x27;Viet&#x27;)&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar1, ar1_err</span>) {\n      <span class=\"hljs-keyword\">if</span> (ar1_err == <span class=\"hljs-literal\">null</span>) {\n        conn.<span class=\"hljs-title function_\">query</span>(<span class=\"hljs-string\">&quot;INSERT INTO Users (first_name,last_name) VALUES (&#x27;Emad&#x27;,&#x27;Alblueshi&#x27;)&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar2, ar2_err</span>) {\n          <span class=\"hljs-keyword\">if</span> (ar2_err == <span class=\"hljs-literal\">null</span>) {\n            <span class=\"hljs-comment\">// Commit the transaction</span>\n            tx.<span class=\"hljs-title function_\">commit</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar3, ar3_err</span>) {\n              <span class=\"hljs-keyword\">if</span> (ar3_err == <span class=\"hljs-literal\">null</span>) {\n                <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Transaction succeeded&quot;</span>);\n              } <span class=\"hljs-keyword\">else</span> {\n                <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Transaction failed &quot;</span> + ar3_err.<span class=\"hljs-title function_\">getMessage</span>());\n              }\n              <span class=\"hljs-comment\">// Return the connection to the pool</span>\n              conn.<span class=\"hljs-title function_\">close</span>();\n            });\n          } <span class=\"hljs-keyword\">else</span> {\n            <span class=\"hljs-comment\">// Return the connection to the pool</span>\n            conn.<span class=\"hljs-title function_\">close</span>();\n          }\n        });\n      } <span class=\"hljs-keyword\">else</span> {\n        <span class=\"hljs-comment\">// Return the connection to the pool</span>\n        conn.<span class=\"hljs-title function_\">close</span>();\n      }\n    });\n  }\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>When the database server reports the current transaction is failed (e.g the infamous <em>current transaction is aborted, commands ignored until\nend of transaction block</em>), the transaction is rollbacked and the <code><a href=\"../../jsdoc/module-vertx-sql-client-js_transaction-Transaction.html#abortHandler\">abortHandler</a></code>\nis called:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\">tx.<span class=\"hljs-title function_\">abortHandler</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">v</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Transaction failed =&gt; rollbacked&quot;</span>);\n});</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect2\">\n<h3 id=\"_simplified_transaction_api\"><a class=\"anchor\" href=\"#_simplified_transaction_api\"></a>Simplified transaction API</h3>\n<div class=\"paragraph\">\n<p>When you use a pool, you can start a transaction directly on the pool.</p>\n</div>\n<div class=\"paragraph\">\n<p>It borrows a connection from the pool, begins the transaction and releases the connection to the pool when the transaction ends.</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-comment\">// Acquire a transaction and begin the transaction</span>\npool.<span class=\"hljs-title function_\">begin</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">res, res_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (res_err == <span class=\"hljs-literal\">null</span>) {\n\n    <span class=\"hljs-comment\">// Get the transaction</span>\n    <span class=\"hljs-keyword\">var</span> tx = res;\n\n    <span class=\"hljs-comment\">// Various statements</span>\n    tx.<span class=\"hljs-title function_\">query</span>(<span class=\"hljs-string\">&quot;INSERT INTO Users (first_name,last_name) VALUES (&#x27;Julien&#x27;,&#x27;Viet&#x27;)&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar1, ar1_err</span>) {\n      <span class=\"hljs-keyword\">if</span> (ar1_err == <span class=\"hljs-literal\">null</span>) {\n        tx.<span class=\"hljs-title function_\">query</span>(<span class=\"hljs-string\">&quot;INSERT INTO Users (first_name,last_name) VALUES (&#x27;Emad&#x27;,&#x27;Alblueshi&#x27;)&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar2, ar2_err</span>) {\n          <span class=\"hljs-keyword\">if</span> (ar2_err == <span class=\"hljs-literal\">null</span>) {\n            <span class=\"hljs-comment\">// Commit the transaction</span>\n            <span class=\"hljs-comment\">// the connection will automatically return to the pool</span>\n            tx.<span class=\"hljs-title function_\">commit</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar3, ar3_err</span>) {\n              <span class=\"hljs-keyword\">if</span> (ar3_err == <span class=\"hljs-literal\">null</span>) {\n                <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Transaction succeeded&quot;</span>);\n              } <span class=\"hljs-keyword\">else</span> {\n                <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Transaction failed &quot;</span> + ar3_err.<span class=\"hljs-title function_\">getMessage</span>());\n              }\n            });\n          }\n        });\n      } <span class=\"hljs-keyword\">else</span> {\n        <span class=\"hljs-comment\">// No need to close connection as transaction will abort and be returned to the pool</span>\n      }\n    });\n  }\n});</code></pre>\n</div>\n</div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">Note</div>\n</td>\n<td class=\"content\">\nthis code will not close the connection because it will always be released back to the pool when the transaction\n</td>\n</tr>\n</table>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_cursors_and_streaming\"><a class=\"anchor\" href=\"#_cursors_and_streaming\"></a>Cursors and streaming</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>By default prepared query execution fetches all rows, you can use a\n<code><a href=\"../../jsdoc/module-vertx-sql-client-js_cursor-Cursor.html\">Cursor</a></code> to control the amount of rows you want to read:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">Tuple</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-sql-client-js/tuple&quot;</span>);\nconnection.<span class=\"hljs-title function_\">prepare</span>(<span class=\"hljs-string\">&quot;SELECT * FROM users WHERE age &gt; ?&quot;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar1, ar1_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (ar1_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">var</span> pq = ar1;\n\n    <span class=\"hljs-comment\">// Create a cursor</span>\n    <span class=\"hljs-keyword\">var</span> cursor = pq.<span class=\"hljs-title function_\">cursor</span>(<span class=\"hljs-title class_\">Tuple</span>.<span class=\"hljs-title function_\">of</span>(<span class=\"hljs-number\">18</span>));\n\n    <span class=\"hljs-comment\">// Read 50 rows</span>\n    cursor.<span class=\"hljs-title function_\">read</span>(<span class=\"hljs-number\">50</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar2, ar2_err</span>) {\n      <span class=\"hljs-keyword\">if</span> (ar2_err == <span class=\"hljs-literal\">null</span>) {\n        <span class=\"hljs-keyword\">var</span> rows = ar2;\n\n        <span class=\"hljs-comment\">// Check for more ?</span>\n        <span class=\"hljs-keyword\">if</span> (cursor.<span class=\"hljs-title function_\">hasMore</span>()) {\n          <span class=\"hljs-comment\">// Repeat the process...</span>\n        } <span class=\"hljs-keyword\">else</span> {\n          <span class=\"hljs-comment\">// No more rows - close the cursor</span>\n          cursor.<span class=\"hljs-title function_\">close</span>();\n        }\n      }\n    });\n  }\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>Cursors shall be closed when they are released prematurely:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\">cursor.<span class=\"hljs-title function_\">read</span>(<span class=\"hljs-number\">50</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar2, ar2_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (ar2_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-comment\">// Close the cursor</span>\n    cursor.<span class=\"hljs-title function_\">close</span>();\n  }\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>A stream API is also available for cursors, which can be more convenient, specially with the Rxified version.</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">Tuple</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-sql-client-js/tuple&quot;</span>);\nconnection.<span class=\"hljs-title function_\">prepare</span>(<span class=\"hljs-string\">&quot;SELECT * FROM users WHERE age &gt; ?&quot;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar1, ar1_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (ar1_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">var</span> pq = ar1;\n\n    <span class=\"hljs-comment\">// Fetch 50 rows at a time</span>\n    <span class=\"hljs-keyword\">var</span> stream = pq.<span class=\"hljs-title function_\">createStream</span>(<span class=\"hljs-number\">50</span>, <span class=\"hljs-title class_\">Tuple</span>.<span class=\"hljs-title function_\">of</span>(<span class=\"hljs-number\">18</span>));\n\n    <span class=\"hljs-comment\">// Use the stream</span>\n    stream.<span class=\"hljs-title function_\">exceptionHandler</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">err</span>) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Error: &quot;</span> + err.<span class=\"hljs-title function_\">getMessage</span>());\n    });\n    stream.<span class=\"hljs-title function_\">endHandler</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">v</span>) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;End of stream&quot;</span>);\n    });\n    stream.<span class=\"hljs-title function_\">handler</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">row</span>) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;User: &quot;</span> + row.<span class=\"hljs-title function_\">getString</span>(<span class=\"hljs-string\">&quot;last_name&quot;</span>));\n    });\n  }\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>The stream read the rows by batch of <code>50</code> and stream them, when the rows have been passed to the handler,\na new batch of <code>50</code> is read and so on.</p>\n</div>\n<div class=\"paragraph\">\n<p>The stream can be resumed or paused, the loaded rows will remain in memory until they are delivered and the cursor\nwill stop iterating.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_db2_type_mapping\"><a class=\"anchor\" href=\"#_db2_type_mapping\"></a>DB2 type mapping</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Currently the client supports the following DB2 types</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>BOOLEAN (<code>java.lang.Boolean</code>) (DB2 LUW only)</p>\n</li>\n<li>\n<p>SMALLINT (<code>java.lang.Short</code>)</p>\n</li>\n<li>\n<p>INTEGER (<code>java.lang.Integer</code>)</p>\n</li>\n<li>\n<p>BIGINT (<code>java.lang.Long</code>)</p>\n</li>\n<li>\n<p>REAL (<code>java.lang.Float</code>)</p>\n</li>\n<li>\n<p>DOUBLE (<code>java.lang.Double</code>)</p>\n</li>\n<li>\n<p>DECIMAL (<code>io.vertx.sqlclient.data.Numeric</code>)</p>\n</li>\n<li>\n<p>CHAR (<code>java.lang.String</code>)</p>\n</li>\n<li>\n<p>VARCHAR (<code>java.lang.String</code>)</p>\n</li>\n<li>\n<p>ENUM (<code>java.lang.String</code>)</p>\n</li>\n<li>\n<p>DATE (<code>java.time.LocalDate</code>)</p>\n</li>\n<li>\n<p>TIME (<code>java.time.LocalTime</code>)</p>\n</li>\n<li>\n<p>TIMESTAMP (<code>java.time.LocalDateTime</code>)</p>\n</li>\n<li>\n<p>BINARY (<code>byte[]</code>)</p>\n</li>\n<li>\n<p>VARBINARY (<code>byte[]</code>)</p>\n</li>\n<li>\n<p>ROWID (<code>io.vertx.db2client.impl.drda.DB2RowId</code> or <code>java.sql.RowId</code>) (DB2 z/OS only)</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Some types that are currently NOT supported are:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>XML</p>\n</li>\n<li>\n<p>BLOB</p>\n</li>\n<li>\n<p>CLOB</p>\n</li>\n<li>\n<p>DBCLOB</p>\n</li>\n<li>\n<p>GRAPHIC / VARGRAPHIC</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>For a further documentation on DB2 data types, see the following resources:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p><a href=\"https://www.ibm.com/support/knowledgecenter/SSEPGG_11.5.0/com.ibm.db2.luw.sql.ref.doc/doc/r0008483.html\">DB2 for LUW 11.5 data types</a></p>\n</li>\n<li>\n<p><a href=\"https://www.ibm.com/support/knowledgecenter/SSEPEK_12.0.0/sqlref/src/tpc/db2z_datatypesintro.html\">DB2 for z/OS 12.0 data types</a></p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\">\n<p>Tuple decoding uses the above types when storing values, it also performs on the fly conversion of the actual value when possible:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\">pool.<span class=\"hljs-title function_\">query</span>(<span class=\"hljs-string\">&quot;SELECT an_int_column FROM exampleTable&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar, ar_err</span>) {\n  <span class=\"hljs-keyword\">var</span> rowSet = ar;\n  <span class=\"hljs-keyword\">var</span> row = rowSet.<span class=\"hljs-title function_\">iterator</span>().<span class=\"hljs-title function_\">next</span>();\n\n  <span class=\"hljs-comment\">// Stored as INTEGER column type and represented as java.lang.Integer</span>\n  <span class=\"hljs-keyword\">var</span> value = row.<span class=\"hljs-title function_\">getValue</span>(<span class=\"hljs-number\">0</span>);\n\n  <span class=\"hljs-comment\">// Convert to java.lang.Long</span>\n  <span class=\"hljs-keyword\">var</span> longValue = row.<span class=\"hljs-title function_\">getLong</span>(<span class=\"hljs-number\">0</span>);\n});</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_using_java_enum_types\"><a class=\"anchor\" href=\"#_using_java_enum_types\"></a>Using Java enum types</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>You can map Java <a href=\"https://docs.oracle.com/javase/tutorial/java/javaOO/enum.html\">enum types</a> to these column\ntypes:</p>\n</div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Strings (VARCHAR, TEXT)</p>\n</li>\n<li>\n<p>Numbers (SMALLINT, INTEGER, BIGINT)</p>\n</li>\n</ul>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">Tuple</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-sql-client-js/tuple&quot;</span>);\nclient.<span class=\"hljs-title function_\">preparedQuery</span>(<span class=\"hljs-string\">&quot;SELECT day_name FROM FINAL TABLE ( INSERT INTO days (day_name) VALUES (?), (?), (?) )&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-title class_\">Tuple</span>.<span class=\"hljs-title function_\">of</span>(<span class=\"hljs-string\">&#x27;FRIDAY&#x27;</span>, <span class=\"hljs-string\">&#x27;SATURDAY&#x27;</span>, <span class=\"hljs-string\">&#x27;SUNDAY&#x27;</span>), <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar, ar_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (ar_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">var</span> rows = ar;\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Inserted &quot;</span> + rows.<span class=\"hljs-title function_\">rowCount</span>() + <span class=\"hljs-string\">&quot; new rows&quot;</span>);\n    <span class=\"hljs-title class_\">Array</span>.<span class=\"hljs-property\"><span class=\"hljs-keyword\">prototype</span></span>.<span class=\"hljs-property\">forEach</span>.<span class=\"hljs-title function_\">call</span>(rows, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">row</span>) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Day: &quot;</span> + row.<span class=\"hljs-title function_\">getValues</span>(<span class=\"hljs-string\">&#x27;class&#x27;</span>, row.<span class=\"hljs-title function_\">getColumnIndex</span>(<span class=\"hljs-string\">&quot;day_name&quot;</span>)));\n    });\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Failure: &quot;</span> + ar_err.<span class=\"hljs-title function_\">getMessage</span>());\n  }\n});\n\n<span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">Tuple</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-sql-client-js/tuple&quot;</span>);\nclient.<span class=\"hljs-title function_\">preparedQuery</span>(<span class=\"hljs-string\">&quot;SELECT day_num FROM FINAL TABLE ( INSERT INTO days (day_num) VALUES (?), (?), (?) )&quot;</span>).<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-title class_\">Tuple</span>.<span class=\"hljs-title function_\">of</span>(<span class=\"hljs-string\">&#x27;FRIDAY&#x27;</span>.<span class=\"hljs-title function_\">ordinal</span>(), <span class=\"hljs-string\">&#x27;SATURDAY&#x27;</span>.<span class=\"hljs-title function_\">ordinal</span>(), <span class=\"hljs-string\">&#x27;SUNDAY&#x27;</span>.<span class=\"hljs-title function_\">ordinal</span>()), <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">ar, ar_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (ar_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">var</span> rows = ar;\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Inserted &quot;</span> + rows.<span class=\"hljs-title function_\">rowCount</span>() + <span class=\"hljs-string\">&quot; new rows&quot;</span>);\n    <span class=\"hljs-title class_\">Array</span>.<span class=\"hljs-property\"><span class=\"hljs-keyword\">prototype</span></span>.<span class=\"hljs-property\">forEach</span>.<span class=\"hljs-title function_\">call</span>(rows, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">row</span>) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Day: &quot;</span> + row.<span class=\"hljs-title function_\">getValues</span>(<span class=\"hljs-string\">&#x27;class&#x27;</span>, row.<span class=\"hljs-title function_\">getColumnIndex</span>(<span class=\"hljs-string\">&quot;day_num&quot;</span>)));\n    });\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Failure: &quot;</span> + ar_err.<span class=\"hljs-title function_\">getMessage</span>());\n  }\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>The String type is matched with the Java enum&#8217;s name returned by the <code>name()</code> method.</p>\n</div>\n<div class=\"paragraph\">\n<p>Number types are matched with the Java enum&#8217;s ordinal returned by the <code>ordinal()</code> method and the row.get() method returns the corresponding enum&#8217;s <code>name()</code> value at the ordinal position of the integer value retrieved.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_collector_queries\"><a class=\"anchor\" href=\"#_collector_queries\"></a>Collector queries</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>You can use Java collectors with the query API:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-title class_\">Code</span> not translatable</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>The collector processing must not keep a reference on the <code><a href=\"../../jsdoc/module-vertx-sql-client-js_row-Row.html\">Row</a></code> as\nthere is a single row used for processing the entire set.</p>\n</div>\n<div class=\"paragraph\">\n<p>The Java <code>Collectors</code> provides many interesting predefined collectors, for example you can\ncreate easily create a string directly from the row set:</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-title class_\">Code</span> not translatable</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_using_ssltls\"><a class=\"anchor\" href=\"#_using_ssltls\"></a>Using SSL/TLS</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>To configure the client to use SSL connection, you can configure the <code><a href=\"../dataobjects.html#DB2ConnectOptions\">DB2ConnectOptions</a></code>\nlike a Vert.x <code>NetClient</code>.</p>\n</div>\n<div class=\"listingblock\">\n<div class=\"content\">\n<pre class=\"highlight\"><code class=\"language-js\" data-lang=\"js\"><span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">DB2Connection</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&quot;vertx-db2-client-js/db2_connection&quot;</span>);\n\n<span class=\"hljs-keyword\">var</span> options = {\n  <span class=\"hljs-string\">&quot;port&quot;</span> : <span class=\"hljs-number\">50001</span>,\n  <span class=\"hljs-string\">&quot;host&quot;</span> : <span class=\"hljs-string\">&quot;the-host&quot;</span>,\n  <span class=\"hljs-string\">&quot;database&quot;</span> : <span class=\"hljs-string\">&quot;the-db&quot;</span>,\n  <span class=\"hljs-string\">&quot;user&quot;</span> : <span class=\"hljs-string\">&quot;user&quot;</span>,\n  <span class=\"hljs-string\">&quot;password&quot;</span> : <span class=\"hljs-string\">&quot;secret&quot;</span>,\n  <span class=\"hljs-string\">&quot;ssl&quot;</span> : <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-string\">&quot;trustStoreOptions&quot;</span> : {\n    <span class=\"hljs-string\">&quot;path&quot;</span> : <span class=\"hljs-string\">&quot;/path/to/keystore.p12&quot;</span>,\n    <span class=\"hljs-string\">&quot;password&quot;</span> : <span class=\"hljs-string\">&quot;keystoreSecret&quot;</span>\n  }\n};\n\n<span class=\"hljs-title class_\">DB2Connection</span>.<span class=\"hljs-title function_\">connect</span>(vertx, options, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">res, res_err</span>) {\n  <span class=\"hljs-keyword\">if</span> (res_err == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-comment\">// Connected with SSL</span>\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Could not connect &quot;</span> + res_err);\n  }\n});</code></pre>\n</div>\n</div>\n<div class=\"paragraph\">\n<p>More information can be found in the <a href=\"http://vertx.io/docs/vertx-core/java/#ssl\">Vert.x documentation</a>.</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\">\n<h2 id=\"_using_a_proxy\"><a class=\"anchor\" href=\"#_using_a_proxy\"></a>Using a proxy</h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>You can also configure the client to use an HTTP/1.x CONNECT, SOCKS4a or SOCKS5 proxy.</p>\n</div>\n<div class=\"paragraph\">\n<p>More information can be found in the <a href=\"http://vertx.io/docs/vertx-core/java/#_using_a_proxy_for_client_connections\">Vert.x documentation</a>.</p>\n</div>\n</div>\n</div>","version":"3.9.5"},"__N_SSG":true}